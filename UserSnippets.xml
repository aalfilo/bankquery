<?xml version = '1.0' encoding = 'UTF-8'?>
<snippets>
   <group category="AAL-PBB" language="PLSQL">
      <snippet name="#REKON PARAMATER" description="">
         <code>
            <![CDATA[SELECT TO_CHAR(COUNT(*),'999,999,999,999') "SPPTLUNAS-BANK",TO_CHAR(SUM(DENDA_SPPT),'999,999,999,999')AS DENDA,
TO_CHAR((SUM(JML_SPPT_YG_DIBAYAR)-SUM(DENDA_SPPT)),'999,999,999,999') "PEMBAYARANSPPT",
TO_CHAR(SUM(JML_SPPT_YG_DIBAYAR),'999,999,999,999') "TOTALPENERIMAAN" FROM PEMBAYARAN_SPPT WHERE THN_PAJAK_SPPT=2014;

SELECT TO_CHAR(count(DECODE(STATUS_PEMBAYARAN_SPPT,1,1)),'999,999,999,999') "SPPTLUNAS-SISMIOP" ,
TO_CHAR(SUM(PBB_YG_HARUS_DIBAYAR_SPPT),'999,999,999,999') "PEMBAYARAN SPPT"
FROM SPPT WHERE THN_PAJAK_SPPT=2014 AND STATUS_PEMBAYARAN_SPPT=1;

SELECT TO_CHAR(count(DECODE(STATUS_PEMBAYARAN_SPPT,0,0)),'999,999,999,999') "SPPTBELUMLUNAS-SISMIOP",
TO_CHAR(SUM(PBB_YG_HARUS_DIBAYAR_SPPT),'999,999,999,999') "PIUTANG SPPT"
 FROM SPPT WHERE THN_PAJAK_SPPT=2014 AND STATUS_PEMBAYARAN_SPPT=0;
 
SELECT TO_CHAR(count(DECODE(STATUS_PEMBAYARAN_SPPT,0,0)),'999,999,999,999') "SPPTBATAL-SISMIOP",
NVL(TO_CHAR(SUM(PBB_YG_HARUS_DIBAYAR_SPPT),'999,999,999,999'),'0') "BATAL SPPT"
 FROM SPPT WHERE THN_PAJAK_SPPT=2014 AND STATUS_PEMBAYARAN_SPPT=2;
 
 SELECT COUNT(*) AS TOTAL FROM SPPT WHERE STATUS_PEMBAYARAN_SPPT=1 AND THN_PAJAK_SPPT=2014;

select NVL(TO_CHAR(SUM(PBB_YG_HARUS_DIBAYAR_SPPT),'999,999,999,999'),'0') AS POKOK,count(*) as total from sppt where THN_PAJAK_SPPT=2014 AND STATUS_PEMBAYARAN_SPPT in (0,1) ]]>
         </code>
      </snippet>
      <snippet name="#OCMS Siapdes" description="">
         <code>
            <![CDATA[SELECT '015' as KODE,
substr(nop,1,2)||substr(nop,4,2)||substr(nop,7,3)||substr(nop,11,3)||substr(nop,15,3)||substr(nop,19,4)||substr(nop,24,1) as NOP,
TAHUN AS TAHUN, NAMA_WP AS NAMA,
PBB_BAYAR AS TAGIHAN,'0' as DENDA
FROM TB_DHKP WHERE
substr(nop,1,2)||substr(nop,4,2)||substr(nop,7,3)||substr(nop,11,3)||substr(nop,15,3)||substr(nop,19,4)||substr(nop,24,1)='332008100300100430' or
substr(nop,1,2)||substr(nop,4,2)||substr(nop,7,3)||substr(nop,11,3)||substr(nop,15,3)||substr(nop,19,4)||substr(nop,24,1)='332008100300100560'

SELECT 
substr(nop,1,2) AS  KD_PROPINSI,
substr(nop,4,2) as KD_DATI2,
 substr(nop,7,3) as KD_KECAMATAN,
 substr(nop,11,3) as KD_KELURAHAN,
 substr(nop,15,3) as KD_BLOK,
 substr(nop,19,4) as NO_URUT,
 substr(nop,24,1) as KD_JNS_OP, 
tahun as THN_PAJAK_SPPT


from [tb_dhkp]
]]>
         </code>
      </snippet>
      <snippet name="#SELISIH PEMBAYARAN" description="">
         <code>
            <![CDATA[SELECT B.KD_PROPINSI ||''||B.KD_DATI2 ||''||
B.KD_KECAMATAN||''||B.KD_KELURAHAN||''||B.KD_BLOK||''||B.NO_URUT ||''||B.KD_JNS_OP AS NOP,
B.NM_WP_SPPT AS NAMA, B.THN_PAJAK_SPPT AS TAHUN , B.PBB_YG_HARUS_DIBAYAR_SPPT as SPPTBAYAR
, C.TGL_PEMBAYARAN_SPPT AS "TGL BAYAR", C.DENDA_SPPT AS DENDA, C.JML_SPPT_YG_DIBAYAR AS BANKBAYAR,
(B.PBB_YG_HARUS_DIBAYAR_SPPT-(C.JML_SPPT_YG_DIBAYAR-C.DENDA_SPPT)) AS SELISIH
FROM SPPT B left join PEMBAYARAN_SPPT C on
B.KD_PROPINSI = C.KD_PROPINSI AND
B.KD_DATI2 = C.KD_DATI2 AND
B.KD_KECAMATAN =C.KD_KECAMATAN AND
B.KD_KELURAHAN = C.KD_KELURAHAN AND
B.KD_BLOK = C.KD_BLOK AND
B.NO_URUT = C.NO_URUT AND
B.KD_JNS_OP =C.KD_JNS_OP and
B.THN_PAJAK_SPPT=C.THN_PAJAK_SPPT
where
B.THN_PAJAK_SPPT=2015
order by selisih asc;]]>
         </code>
      </snippet>
      <snippet name="#UPDATE PEMBAYARAN DARI T.PEMBAYARAN" description="">
         <code>
            <![CDATA[UPDATE SPPT SET STATUS_PEMBAYARAN_SPPT=1
WHERE STATUS_PEMBAYARAN_SPPT=0 AND EXISTS (SELECT JML_SPPT_YG_DIBAYAR FROM PEMBAYARAN_SPPT B
WHERE SPPT.KD_DATI2 = B.KD_DATI2 AND
SPPT.KD_KECAMATAN =B.KD_KECAMATAN AND
SPPT.KD_KELURAHAN = B.KD_KELURAHAN AND
SPPT.KD_BLOK = B.KD_BLOK AND
SPPT.NO_URUT = B.NO_URUT AND
SPPT.KD_JNS_OP =B.KD_JNS_OP AND
SPPT.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT AND B.JML_SPPT_YG_DIBAYAR IS NOT NULL AND THN_PAJAK_SPPT=2013)]]>
         </code>
      </snippet>
      <snippet name="#URUTAN DESA LUNAS" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE, 
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK, 
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG", 
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI", 
count(*) as JMLSPPT, 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "BELUMLUNAS", 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) "LUNAS", 
TRUNC((COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) / count(*))*100,2) AS PERSENTASE, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000 AND 100000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 1 ELSE 0 END) AS R1, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 100001 AND 500000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 1 ELSE 0 END) AS R2, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 500001 AND 1000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 1 ELSE 0 END) AS R3, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1000001 AND 2000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 1 ELSE 0 END) AS R4, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000001 AND 5000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 1 ELSE 0 END) AS R5, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000001 AND 10000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 1 ELSE 0 END) AS R6, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 10000001 AND 25000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 1 ELSE 0 END) AS R7, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 25000001 AND 60000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 1 ELSE 0 END) AS R8, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 60000001  AND 300000000) AND (S.STATUS_PEMBAYARAN_SPPT=1))   THEN 1 ELSE 0 END) AS R9, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000  AND 100000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 1500 ELSE 0 END) AS H1, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 100001  AND 500000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 8000 ELSE 0 END) AS H2, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 500001  AND 1000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 25000 ELSE 0 END) AS H3, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1000001  AND 2000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 50000 ELSE 0 END) AS H4, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000001  AND 5000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 350000 ELSE 0 END) AS H5, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000001  AND 10000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 550000 ELSE 0 END) AS H6, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 10000001  AND 25000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 800000 ELSE 0 END) AS H7, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 25000001  AND 60000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 2000000 ELSE 0 END) AS H8, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT)  BETWEEN 60000001  AND 300000000 ) AND (S.STATUS_PEMBAYARAN_SPPT=1)) THEN 3000000 ELSE 0 END) AS H9 
FROM SPPT S  
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN pembayaran_sppt B ON ( 
S.KD_PROPINSI=B.KD_PROPINSI AND 
S.KD_DATI2=B.KD_DATI2 AND 
S.KD_KECAMATAN=B.KD_KECAMATAN AND 
S.KD_KELURAHAN=B.KD_KELURAHAN AND 
S.KD_BLOK=B.KD_BLOK AND 
S.NO_URUT=B.NO_URUT AND 
S.KD_JNS_OP=B.KD_JNS_OP AND 
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT 
) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
WHERE  S.THN_PAJAK_SPPT=2015 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1) and  
S.PBB_YG_HARUS_DIBAYAR_SPPT <300000000 AND 
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320100004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061013 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061009 and
-- tahap 1
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090011 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030015 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030003 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030007 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030011 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320050011 AND
-- tahap 2
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010013 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010018 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030013 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040015 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040018 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041013 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041014 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320050003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320050004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320050007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320050008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320050010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320060012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061014 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061015 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320070006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081009 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090019 and 
--TAHAP 3
 LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091008 and 
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010009 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020009 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090009 and
-- tahap 4
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041015 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080001 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080003 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010003 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041006 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041011 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090004 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041002 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091003 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090001 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091006 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041001 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010004 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091004 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030009 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320070008 and
-- tahap 5 
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010011 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040014 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041005 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030010 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021005 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090010 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080009 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091002 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041008 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091005 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090008 and
--tahap6
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010001 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010016 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010017 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021010 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040012 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041003 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041007 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041012 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080008 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080012 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090005 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091001 and
--tahap7
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010012 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090002 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090003 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041009 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071005 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020008 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030014 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030012 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320050009 and
--tahap8
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010005 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010014 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010015 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020011 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040002 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040013 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040017 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320070007 and
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091007 
-- tahap 9
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY persentase desc
]]>
         </code>
      </snippet>
      <snippet name="#BONUS DESA - KECAMATAN" description="">
         <code>
            <![CDATA[-- bonus lunas desa
=IF(G3<10000001;800000;
IF(G3<20000001;1000000;
IF(G3<45000001;1500000;
IF(G3<60000001;1700000;
IF(G3<75000001;1900000;
IF(G3<90000001;2100000;
IF(G3<105000001;2300000;
IF(G3<120000001;2500000;
IF(G3<135000001;2700000;
IF(G3<150000001;2900000;
IF(G3<165000001;3100000;
IF(G3<180000001;3300000;
IF(G3<195000001;3500000;
IF(G3<210000001;3700000;
IF(G3<225000001;3900000;
IF(G3<240000001;4100000;
IF(G3<255000001;4700000;
IF(G3<270000001;4900000;
IF(G3<285000001;5100000;
IF(G3<300000001;5300000;
IF(G3<315000001;5100000;
IF(G3<330000001;5300000;5500000))))))))))))))))))))))

--bonus kecamatan

=IF(G3<10000001;125000;
IF(G3<20000001;175000;
IF(G3<45000001;225000;
IF(G3<60000001;325000;
IF(G3<75000001;425000;
IF(G3<90000001;525000;
IF(G3<105000001;625000;
IF(G3<120000001;725000;
IF(G3<135000001;825000;
IF(G3<150000001;925000;
IF(G3<165000001;1025000;
IF(G3<180000001;1125000;1225000))))))))))))

]]>
         </code>
      </snippet>
      <snippet name="#OCMS PIUTANG" description="">
         <code>
            <![CDATA[SELECT '015' as KODE,a.KD_PROPINSI||''||a.KD_DATI2|
|''||a.KD_KECAMATAN||''||a.KD_KELURAHAN||''||a.KD_BLOK||''||a.NO_URUT||''||A.KD_JNS_OP AS NOP,
a.THN_PAJAK_SPPT AS TAHUN, a.NM_WP_SPPT AS NAMA,
a.PBB_YG_HARUS_DIBAYAR_SPPT AS TAGIHAN,'0' as DENDA
FROM SPPT a WHERE a.STATUS_PEMBAYARAN_SPPT=0 and
A.KD_PROPINSI||A.KD_DATI2||A.KD_KECAMATAN||A.KD_KELURAHAN||A.KD_BLOK||A.NO_URUT||A.KD_JNS_OP IN ( 
332006000202101290
)

AND a.THN_PAJAK_SPPT BETWEEN 2009 and 2015 and PBB_YG_HARUS_DIBAYAR_SPPT not in 0 ORDER BY
a.KD_PROPINSI||''||a.KD_DATI2||''||a.KD_KECAMATAN||''||a.KD_KELURAHAN||''||a.KD_BLOK||''||a.NO_URUT||''||A.KD_JNS_OP asc
]]>
         </code>
      </snippet>
      <snippet name="#UPDATE OCMS KETETAPANJ" description="">
         <code>
            <![CDATA[SELECT '015' as KODE,a.KD_PROPINSI||''||a.KD_DATI2|
|''||a.KD_KECAMATAN||''||a.KD_KELURAHAN||''||a.KD_BLOK||''||a.NO_URUT||''||A.KD_JNS_OP AS NOP,
a.THN_PAJAK_SPPT AS TAHUN, a.NM_WP_SPPT AS NAMA,
a.PBB_YG_HARUS_DIBAYAR_SPPT AS TAGIHAN,'0' as DENDA
FROM SPPT a WHERE STATUS_PEMBAYARAN_SPPT='0' AND a.THN_PAJAK_SPPT=2016
AND a.TGL_TERBIT_SPPT BETWEEN TO_CHAR(TO_DATE(SYSDATE,'DD/MM/YY')-10)AND TO_CHAR(TO_DATE(SYSDATE,'DD/MM/YY'))  and PBB_YG_HARUS_DIBAYAR_SPPT not in 0 ORDER BY
a.KD_PROPINSI||''||a.KD_DATI2||''||a.KD_KECAMATAN||''||a.KD_KELURAHAN||''||a.KD_BLOK||''||a.NO_URUT||''||A.KD_JNS_OP asc

]]>
         </code>
      </snippet>
      <snippet name="#UPDATE ANOTHER ROWJ" description="">
         <code>
            <![CDATA[update SPPT a set a.PBB_TERHUTANG_SPPT=(select b.PBB_TERHUTANG_SPPT from SPPT b where  A.KD_PROPINSI=B.KD_PROPINSI AND
A.KD_DATI2=B.KD_DATI2 AND
A.KD_KECAMATAN=B.KD_KECAMATAN AND
A.KD_KELURAHAN=B.KD_KELURAHAN AND
A.KD_BLOK=B.KD_BLOK AND
A.NO_URUT=B.NO_URUT AND
A.KD_JNS_OP=B.KD_JNS_OP AND b.THN_PAJAK_SPPT=2013),
a.NJOP_SPPT=(select NJOP_SPPT from SPPT b where  A.KD_PROPINSI=B.KD_PROPINSI AND
A.KD_DATI2=B.KD_DATI2 AND
A.KD_KECAMATAN=B.KD_KECAMATAN AND
A.KD_KELURAHAN=B.KD_KELURAHAN AND
A.KD_BLOK=B.KD_BLOK AND
A.NO_URUT=B.NO_URUT AND
A.KD_JNS_OP=B.KD_JNS_OP AND b.THN_PAJAK_SPPT=2013),
a.PBB_YG_HARUS_DIBAYAR_SPPT=(select PBB_YG_HARUS_DIBAYAR_SPPT from SPPT b where  A.KD_PROPINSI=B.KD_PROPINSI AND
A.KD_DATI2=B.KD_DATI2 AND
A.KD_KECAMATAN=B.KD_KECAMATAN AND
A.KD_KELURAHAN=B.KD_KELURAHAN AND
A.KD_BLOK=B.KD_BLOK AND
A.NO_URUT=B.NO_URUT AND
A.KD_JNS_OP=B.KD_JNS_OP AND b.THN_PAJAK_SPPT=2013),
a.NM_WP_SPPT=(select NM_WP_SPPT from SPPT b where  A.KD_PROPINSI=B.KD_PROPINSI AND
A.KD_DATI2=B.KD_DATI2 AND
A.KD_KECAMATAN=B.KD_KECAMATAN AND
A.KD_KELURAHAN=B.KD_KELURAHAN AND
A.KD_BLOK=B.KD_BLOK AND
A.NO_URUT=B.NO_URUT AND
A.KD_JNS_OP=B.KD_JNS_OP AND b.THN_PAJAK_SPPT=2013),
a.LUAS_BUMI_SPPT=(select LUAS_BUMI_SPPT from SPPT b where  A.KD_PROPINSI=B.KD_PROPINSI AND
A.KD_DATI2=B.KD_DATI2 AND
A.KD_KECAMATAN=B.KD_KECAMATAN AND
A.KD_KELURAHAN=B.KD_KELURAHAN AND
A.KD_BLOK=B.KD_BLOK AND
A.NO_URUT=B.NO_URUT AND
A.KD_JNS_OP=B.KD_JNS_OP AND b.THN_PAJAK_SPPT=2013),
a.LUAS_BNG_SPPT=(select LUAS_BNG_SPPT from SPPT b where  A.KD_PROPINSI=B.KD_PROPINSI AND
A.KD_DATI2=B.KD_DATI2 AND
A.KD_KECAMATAN=B.KD_KECAMATAN AND
A.KD_KELURAHAN=B.KD_KELURAHAN AND
A.KD_BLOK=B.KD_BLOK AND
A.NO_URUT=B.NO_URUT AND
A.KD_JNS_OP=B.KD_JNS_OP AND b.THN_PAJAK_SPPT=2013)
WHERE A.THN_PAJAK_SPPT=2014 AND
A.KD_PROPINSI||A.KD_DATI2||A.KD_KECAMATAN||A.KD_KELURAHAN||A.KD_BLOK||A.NO_URUT||A.KD_JNS_OP='332003000500500200';]]>
         </code>
      </snippet>
      <snippet name="#DBSIAPDES" description="">
         <code>
            <![CDATA[
SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP,
S.NM_WP_SPPT AS NAMA_WP,S.PBB_YG_HARUS_DIBAYAR_SPPT AS PBB_BAYAR,0 "DENDA",S.THN_PAJAK_SPPT "TAHUN", K.NM_KECAMATAN AS KECAMATAN,
L.NM_KELURAHAN "DESA", S.JLN_WP_SPPT||' - '||L.NM_KELURAHAN AS ALAMAT,S.LUAS_BUMI_SPPT "LUAS_BUMI",S.LUAS_BNG_SPPT "LUAS_BNG",
S.STATUS_PEMBAYARAN_SPPT "STATUSBAYAR",nvl(TO_CHAR(B.TGL_PEMBAYARAN_SPPT,'YYYY-MM-DD'),'2015-01-01') AS TANGGAL_TRANS
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where s.THN_PAJAK_SPPT=TO_CHAR(sysdate,'YYYY') and S.STATUS_PEMBAYARAN_SPPT in (0,1) and K.KD_KECAMATAN=081 AND L.KD_KELURAHAN=010 AND
(
S.NM_WP_SPPT NOT  LIKE ( '%TELKOM%') AND 
S.NM_WP_SPPT NOT  LIKE ( '%TELKOMSEL%') AND 
S.NM_WP_SPPT NOT  LIKE ('%INDOSAT%') AND 
S.NM_WP_SPPT NOT  LIKE ('%PROTELINDO%') AND 
S.NM_WP_SPPT  NOT LIKE ('%XL AXIATA%') AND 
S.NM_WP_SPPT NOT  LIKE ('%NATRINDO%')AND 
S.NM_WP_SPPT NOT  LIKE ('%JAVA POWER%') AND
S.NM_WP_SPPT NOT  LIKE ('%TOWER BERSAMA%') AND
S.NM_WP_SPPT NOT  LIKE ('%PT. KERETA API INDONESIA%') 

)

ORDER BY K.NM_KECAMATAN,S.KD_KELURAHAN ASC;
===================================


SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP,
B.NM_WP AS NAMA,
L.NM_KELURAHAN AS DESA,
K.NM_KECAMATAN AS KECAMATAN,S.TOTAL_LUAS_BUMI AS BUMI,S.TOTAL_LUAS_BNG AS BANGUNAN,S.JALAN_OP||' RT.'||S.RT_OP||' RW.'||S.RW_OP AS ALAMATOP,
B.JALAN_WP||' RT.'||B.RT_WP||' RW.'||B.RW_WP||' '||B.KELURAHAN_WP||'-'||B.KOTA_WP  AS ALAMATWP,
CASE S.KD_STATUS_WP  WHEN '1' THEN 'PEMILIK' WHEN '2' THEN 'PENYEWA' WHEN '3' THEN 'PENGELOLA' 
WHEN '4' THEN 'PEMAKAI' ELSE 'SENGKETA' END AS STATUSWP
 FROM DAT_OBJEK_PAJAK S
LEFT JOIN DAT_SUBJEK_PAJAK B ON (
S.SUBJEK_PAJAK_ID=B.SUBJEK_PAJAK_ID 
)
LEFT JOIN DAT_OP_BUMI D ON ( 
S.KD_PROPINSI=D.KD_PROPINSI AND
S.KD_DATI2=D.KD_DATI2 AND
S.KD_KECAMATAN=D.KD_KECAMATAN AND
S.KD_KELURAHAN=D.KD_KELURAHAN AND
S.KD_BLOK=D.KD_BLOK AND
S.NO_URUT=D.NO_URUT AND
S.KD_JNS_OP=D.KD_JNS_OP 
)

LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN
)
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN
)
WHERE S.KD_KECAMATAN IN (040,041,050) AND B.NM_WP NOT IN ('GBG') AND D.JNS_BUMI NOT IN ('5')
ORDER BY S.KD_KECAMATAN,S.KD_KELURAHAN,S.KD_BLOK,S.NO_URUT ASC

]]>
         </code>
      </snippet>
      <snippet name="#nop" description="">
         <code>
            <![CDATA[SELECT  KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP as NOP,
NM_WP_SPPT AS NAMA_WP,PBB_YG_HARUS_DIBAYAR_SPPT AS PBB_BAYAR,STATUS_PEMBAYARAN_SPPT FROM SPPT WHERE KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP in (
332007100509400360,
332007100509400390,
332007100509600020,
332007100509900220,
332009100600801440
) AND THN_PAJAK_SPPT='2018' ORDER BY KD_KECAMATAN,KD_KELURAHAN,KD_BLOK,NO_URUT ASC

UPDATE SPPT SET NM_WP_SPPT='TUMIRAH', PBB_YG_HARUS_DIBAYAR_SPPT=25777 WHERE KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP='332009100600801440' AND THN_PAJAK_SPPT='2018'


delete  from BILLER_DETAIL where  KD_PROVINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP in (
332008101100100460,
332008101102902080,
332008101102302560


) AND TAHUN_SPPT='2019' ]]>
         </code>
      </snippet>
      <snippet name="#penerimaan per tahun" description="">
         <code>
            <![CDATA[SELECT THN_PAJAK_SPPT, count(*) as sppt,  sum(JML_SPPT_YG_DIBAYAR) as total FROM PEMBAYARAN_SPPT
WHERE TGL_PEMBAYARAN_SPPT between TO_DATE('2014-01-01','YYYY-MM-DD') AND  TO_DATE('2014-12-31','YYYY-MM-DD') AND THN_PAJAK_SPPT BETWEEN 2009 AND 2014 
GROUP BY THN_PAJAK_SPPT order by THN_PAJAK_SPPT asc]]>
         </code>
      </snippet>
      <snippet name="#PENERIMAAN PER TGL BULANAN" description="">
         <code>
            <![CDATA[SELECT TO_DATE(TGL_PEMBAYARAN_SPPT,'dd-mm-yyyy') as TGL, sum(JML_SPPT_YG_DIBAYAR) as total,count(*) as sppt FROM PEMBAYARAN_SPPT
WHERE TGL_PEMBAYARAN_SPPT between TO_DATE('01012016','ddmmyyyy') and TO_DATE('31122016','ddmmyyyy') 
and THN_PAJAK_SPPT between 2009 and 2016 GROUP BY TO_DATE(TGL_PEMBAYARAN_SPPT, 'dd-mm-yyyy') ORDER BY TO_DATE(TGL_PEMBAYARAN_SPPT, 'dd-mm-yyyy') desc;]]>
         </code>
      </snippet>
      <snippet name="" description="#PIUTANG SIMULASI">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE,
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK,
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG",count(*) as JMLSPPT

FROM SPPT S 
LEFT JOIN REF_KECAMATAN K ON
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN
LEFT JOIN REF_KELURAHAN L ON
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN
WHERE  THN_PAJAK_SPPT BETWEEN 2009 AND 2013 AND S.STATUS_PEMBAYARAN_SPPT IN(0) AND S.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY')

GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY K.KD_KECAMATAN,KODE ASC]]>
         </code>
      </snippet>
      <snippet name="#CEK PIUTANG KEC" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK, 
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG",count(*) as JMLSPPT 
 
FROM SPPT S  
LEFT JOIN REF_KECAMATAN K ON 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN 
LEFT JOIN REF_KELURAHAN L ON 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN 
WHERE  THN_PAJAK_SPPT=2011 AND S.STATUS_PEMBAYARAN_SPPT IN(0) AND S.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') 
 
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN ORDER BY K.KD_KECAMATAN ASC]]>
         </code>
      </snippet>
      <snippet name="#cek piutang desa" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE,
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK,
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI",
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG",
count(*) as JMLSPPT,
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "BELUMLUNAS",
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) "LUNAS",
TRUNC((COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) / count(*))*100,2) AS PERSENTASE
FROM SPPT S 
LEFT JOIN REF_KECAMATAN K ON
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN
LEFT JOIN REF_KELURAHAN L ON
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN
WHERE  THN_PAJAK_SPPT=2010 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1) and K.KD_KECAMATAN in (020,021,030,040,050,060,061,070,080,090,100  )
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320'),persentase asc
]]>
         </code>
      </snippet>
      <snippet name="#PIUTANG 2013" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE,  
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK,  
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI",
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG",COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "BELUMLUNAS" 
  
FROM SPPT S   
LEFT JOIN REF_KECAMATAN K ON  
S.KD_PROPINSI=K.KD_PROPINSI AND  
S.KD_DATI2=K.KD_DATI2 AND  
S.KD_KECAMATAN=K.KD_KECAMATAN  
LEFT JOIN REF_KELURAHAN L ON  
S.KD_PROPINSI=L.KD_PROPINSI AND  
S.KD_DATI2=L.KD_DATI2 AND  
S.KD_KECAMATAN=L.KD_KECAMATAN AND  
S.KD_KELURAHAN=L.KD_KELURAHAN  
WHERE  THN_PAJAK_SPPT=2013 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1)  AND S.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY')  
  
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY K.KD_KECAMATAN,KODE,piutang ASC]]>
         </code>
      </snippet>
      <snippet name="#dbbimtek" description="">
         <code>
            <![CDATA[SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP,
S.NM_WP_SPPT AS NAMA_WP,S.PBB_YG_HARUS_DIBAYAR_SPPT AS PBB_BAYAR,0 "DENDA",S.THN_PAJAK_SPPT "TAHUN", K.NM_KECAMATAN AS KECAMATAN,
L.NM_KELURAHAN "DESA", S.JLN_WP_SPPT||' - '||L.NM_KELURAHAN AS ALAMAT,S.LUAS_BUMI_SPPT "LUAS_BUMI",S.LUAS_BNG_SPPT "LUAS_BNG",
0 "STATUSBAYAR",'2014-01-09' "TANGGAL_TRANS",0 "keterangan"

FROM SPPT S
LEFT JOIN REF_KECAMATAN K ON
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN
LEFT JOIN REF_KELURAHAN L ON
S.KD_KELURAHAN=L.KD_KELURAHAN AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_PROPINSI=L.KD_PROPINSI
where THN_PAJAK_SPPT=2009 and S.STATUS_PEMBAYARAN_SPPT in (0,1) and K.KD_KECAMATAN=060 AND S.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY')  ORDER BY K.NM_KECAMATAN,S.KD_KELURAHAN ASC;

]]>
         </code>
      </snippet>
      <snippet name="#DBSPPT - PEMBAYARAN" description="">
         <code>
            <![CDATA[SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'-'||S.NO_URUT||'.'||S.KD_JNS_OP AS NOP,
S.thn_pajak_sppt AS TAHUN,S.nm_wp_sppt AS NAMA,S.pbb_yg_harus_dibayar_sppt AS POKOK,
CASE S.STATUS_PEMBAYARAN_SPPT WHEN '0' THEN 'BELUM BAYAR' WHEN '1' THEN 'BAYAR' ELSE 'BATAL' END AS STSBAYAR,
B.TGL_PEMBAYARAN_SPPT AS TGLBAYAR,s.tgl_jatuh_tempo_sppt as TGLTMP,B.JML_SPPT_YG_DIBAYAR AS JMLBAYAR,S.status_pembayaran_sppt AS STSBYRR
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)

where S.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') AND B.TGL_PEMBAYARAN_SPPT > TO_DATE('01-01-2014','DD-MM-YYYY') AND
S.KD_KECAMATAN=021]]>
         </code>
      </snippet>
      <snippet name="#DATA REKAP DESA penerimaan piutang209-2013 " description="">
         <code>
            <![CDATA[SELECT  K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE,S.THN_PAJAK_SPPT,
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI",COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) "WP"
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where S.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') AND B.TGL_PEMBAYARAN_SPPT > TO_DATE('01-01-2014','DD-MM-YYYY') AND
S.KD_KECAMATAN=021 AND S.STATUS_PEMBAYARAN_SPPT=1 and S.THN_PAJAK_SPPT between 2009 and 2013
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN,S.THN_PAJAK_SPPT
]]>
         </code>
      </snippet>
      <snippet name="#JUMLAH PELAYANAN" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE,
count(*) as JMLSPPT
FROM PST_DETAIL S 
LEFT JOIN REF_KECAMATAN K ON
S.KD_PROPINSI_PEMOHON=K.KD_PROPINSI AND
S.KD_DATI2_PEMOHON=K.KD_DATI2 AND
S.KD_KECAMATAN_PEMOHON=K.KD_KECAMATAN
LEFT JOIN REF_KELURAHAN L ON
S.KD_PROPINSI_PEMOHON=L.KD_PROPINSI AND
S.KD_DATI2_PEMOHON=L.KD_DATI2 AND
S.KD_KECAMATAN_PEMOHON=L.KD_KECAMATAN AND
S.KD_KELURAHAN_PEMOHON=L.KD_KELURAHAN
WHERE  S.THN_PELAYANAN=2014 and S.KD_KECAMATAN_PEMOHON=040
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')]]>
         </code>
      </snippet>
      <snippet name="#pelayanan" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE,
count(*) as JMLSPPT,
COUNT(DECODE(S.KD_JNS_PELAYANAN,01,1)) as "PENDAFTARAN OP BARU",
COUNT(DECODE(S.KD_JNS_PELAYANAN,02,1)) as "MUTASI OBJEK/SUBJEK",
COUNT(DECODE(S.KD_JNS_PELAYANAN,03,1)) as "PEMBETULAN SPPT/SKP/STP",
COUNT(DECODE(S.KD_JNS_PELAYANAN,04,1)) as "PEMBATALAN SPPT/SKP",
COUNT(DECODE(S.KD_JNS_PELAYANAN,05,1)) as "SALINAN SPPT/SKP",
COUNT(DECODE(S.KD_JNS_PELAYANAN,06,1)) as "KEBERATAN PENUNJUKAN WPAJAK",
COUNT(DECODE(S.KD_JNS_PELAYANAN,07,1)) as "KEBERATAN ATAS PAJAK TERHUTANG",
COUNT(DECODE(S.KD_JNS_PELAYANAN,08,1)) as "PENGURANGAN BESAR P TERHUTANG",
COUNT(DECODE(S.KD_JNS_PELAYANAN,09,1)) as "RESTITUSI DAN KOMPENSASI",
COUNT(DECODE(S.KD_JNS_PELAYANAN,10,1)) as "PENGURANGAN DENDA ADMINISTRASI",
COUNT(DECODE(S.KD_JNS_PELAYANAN,11,1)) as "PENENTUAN KEMBLI TGL J.TEMPO",
COUNT(DECODE(S.KD_JNS_PELAYANAN,12,1)) as "PENUNDAAN TGL JATUH TEMPO SPOP",
COUNT(DECODE(S.KD_JNS_PELAYANAN,13,1)) as "PEMBERIAN INFORMASI PBB",
COUNT(DECODE(S.KD_JNS_PELAYANAN,14,1)) as "PEMBETULAN SK KEBERATAN",
COUNT(DECODE(S.KD_JNS_PELAYANAN,16,1)) as "FASILITAS UMUM",
COUNT(DECODE(S.KD_JNS_PELAYANAN,15,1)) as "PENGHAPUSAN/PENGGABUNGAN"

FROM PST_DETAIL S 
left join REF_JNS_PELAYANAN j on s.KD_JNS_PELAYANAN=j.KD_JNS_PELAYANAN 
LEFT JOIN REF_KECAMATAN K ON
S.KD_PROPINSI_PEMOHON=K.KD_PROPINSI AND
S.KD_DATI2_PEMOHON=K.KD_DATI2 AND
S.KD_KECAMATAN_PEMOHON=K.KD_KECAMATAN
LEFT JOIN REF_KELURAHAN L ON
S.KD_PROPINSI_PEMOHON=L.KD_PROPINSI AND
S.KD_DATI2_PEMOHON=L.KD_DATI2 AND
S.KD_KECAMATAN_PEMOHON=L.KD_KECAMATAN AND
S.KD_KELURAHAN_PEMOHON=L.KD_KELURAHAN
WHERE  S.THN_PELAYANAN=2015 
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')]]>
         </code>
      </snippet>
      <snippet name="#replace" description="">
         <code>
            <![CDATA[select replace(NM_WP_SPPT, '"', '/') as hh from sppt where NM_WP_SPPT like '%"%' and  KD_KECAMATAN=071; 

update sppt set NM_WP_SPPT=replace(NM_WP_SPPT, '"', '/') where NM_WP_SPPT like '%"%' and  KD_KECAMATAN=071; 
]]>
         </code>
      </snippet>
      <snippet name="#bpkksc" description="">
         <code>
            <![CDATA[SELECT B.KD_PROPINSI ||'.'||B.KD_DATI2 ||'.'|| B.KD_KECAMATAN||'.'||B.KD_KELURAHAN||'.'||B.KD_BLOK||'-'||B.NO_URUT ||'.'||B.KD_JNS_OP AS NOP
, B.NM_WP_SPPT AS NAMA, B.THN_PAJAK_SPPT AS TAHUN , B.PBB_YG_HARUS_DIBAYAR_SPPT as JUMLAH
, C.TGL_PEMBAYARAN_SPPT AS "TGL BAYAR"
, JLN_WP_SPPT||' BLOK ' ||BLOK_KAV_NO_WP_SPPT||' RT : ' ||RW_WP_SPPT ||' RW : ' ||RT_WP_SPPT||' KEL. ' ||KELURAHAN_WP_SPPT||' KEC. '||NM_KECAMATAN AS ALAMAT
, B.LUAS_BUMI_SPPT AS "LUAS BUMI"
, B.kd_kls_tanah AS "KD KELAS TANAH"
, nilai_per_m2_tanah*1000 AS "NJOP TANAH PER METER"
, luas_bumi_sppt*(nilai_per_m2_tanah*1000) AS "TOTAL NJOP TANAH"
, B.LUAS_BNG_SPPT AS "LUAS BANGUNAN"
, B.kd_kls_bng AS "KD KELAS BANGUNAN"
, nilai_per_m2_BNG*1000 AS "NJOP BANGUNAN PER METER"
, luas_bng_sppt*(nilai_per_m2_bng*1000) AS "TOTAL NJOP BANGUNAN"
, TGL_PEMBAYARAN_SPPT AS "STATUS PEMBAYARAN"
, decode(status_pembayaran_sppt,'1','Sudah','Belum') STATUS
FROM SPPT B
join PEMBAYARAN_SPPT C on
 B.KD_PROPINSI = C.KD_PROPINSI AND
B.KD_DATI2 = C.KD_DATI2 AND
B.KD_KECAMATAN =C.KD_KECAMATAN AND
B.KD_KELURAHAN = C.KD_KELURAHAN AND
B.KD_BLOK = C.KD_BLOK AND
B.NO_URUT = C.NO_URUT AND
B.KD_JNS_OP =C.KD_JNS_OP and
B.THN_PAJAK_SPPT=C.THN_PAJAK_SPPT
JOIN  ref_kecamatan ON B.KD_KECAMATAN = ref_kecamatan.KD_KECAMATAN
JOIN  ref_kelurahan ON B.KD_kelurahan = ref_kelurahan.KD_kelurahan and b.KD_kecamatan = ref_kelurahan.KD_kecamatan
JOIN KELAS_TANAH  on B.kd_kls_tanah = KELAS_TANAH.kd_kls_tanah
JOIN KELAS_BANGUNAN  on B.kd_kls_bng = KELAS_BANGUNAN.kd_kls_bng
WHERE B.THN_PAJAK_SPPT='2013'
ORDER BY NOP ;]]>
         </code>
      </snippet>
      <snippet name="#OBJEK PAJAK" description="">
         <code>
            <![CDATA[SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP, 
B.NM_WP AS NAMA,B.SUBJEK_PAJAK_ID, 
S.JALAN_OP||' RT.'||S.RT_OP||' RW.'||S.RW_OP "ALAMAT OP",L.NM_KELURAHAN AS DESA,K.NM_KECAMATAN AS KECAMATAN,S.TOTAL_LUAS_BUMI AS BUMI, 
S.TOTAL_LUAS_BNG AS BNG,D.JNS_BUMI,D.KD_ZNT,N.NIR*1000 AS NIR, 
S.TOTAL_LUAS_BUMI*(1000*H.NILAI_PER_M2_TANAH) "NJOP BUMI",S.TOTAL_LUAS_BNG*(1000*N.NILAI_PER_M2_BNG)"NJOP BANGUNAN" ,T.THN_PAJAK_SPPT AS TAHUN,NVL(T.PBB_YG_HARUS_DIBAYAR_SPPT,'0') AS PBB,  
case T.STATUS_PEMBAYARAN_SPPT when '1' then 'LUNAS' WHEN '0' THEN 'BELUM LUNAS' END AS STATUSBAYAR,P.TGL_PEMBAYARAN_SPPT AS TGL_BAYAR,S.TGL_PENDATAAN_OP,S.TGL_PEREKAMAN_OP,S.NIP_PEREKAM_OP 
FROM DAT_OBJEK_PAJAK S  
LEFT JOIN DAT_SUBJEK_PAJAK B ON ( 
S.SUBJEK_PAJAK_ID=B.SUBJEK_PAJAK_ID  
) 
LEFT JOIN SPPT T ON ( 
S.KD_PROPINSI=T.KD_PROPINSI AND 
S.KD_DATI2=T.KD_DATI2 AND 
S.KD_KECAMATAN=T.KD_KECAMATAN AND 
S.KD_KELURAHAN=T.KD_KELURAHAN AND 
S.KD_BLOK=T.KD_BLOK AND 
S.NO_URUT=T.NO_URUT AND 
S.KD_JNS_OP=T.KD_JNS_OP AND 
T.THN_PAJAK_SPPT=2015 
) 
LEFT JOIN KELAS_TANAH H ON (  
T.KD_KLS_TANAH=H.KD_KLS_TANAH 
) 
LEFT JOIN KELAS_BANGUNAN N ON (  
T.KD_KLS_BNG=N.KD_KLS_BNG  
) 
LEFT JOIN DAT_OP_BUMI D ON (  
S.KD_PROPINSI=D.KD_PROPINSI AND 
S.KD_DATI2=D.KD_DATI2 AND 
S.KD_KECAMATAN=D.KD_KECAMATAN AND 
S.KD_KELURAHAN=D.KD_KELURAHAN AND 
S.KD_BLOK=D.KD_BLOK AND 
S.NO_URUT=D.NO_URUT AND 
S.KD_JNS_OP=D.KD_JNS_OP  
) 
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
LEFT JOIN DAT_NIR N ON ( 
D.KD_PROPINSI=N.KD_PROPINSI AND 
D.KD_DATI2=N.KD_DATI2 AND 
D.KD_KECAMATAN=N.KD_KECAMATAN AND 
D.KD_KELURAHAN=N.KD_KELURAHAN AND 
D.KD_ZNT=N.KD_ZNT AND 
N.THN_NIR_ZNT=2015 
)  
LEFT JOIN PEMBAYARAN_SPPT P ON ( 
S.KD_PROPINSI=P.KD_PROPINSI AND 
S.KD_DATI2=P.KD_DATI2 AND 
S.KD_KECAMATAN=P.KD_KECAMATAN AND 
S.KD_KELURAHAN=P.KD_KELURAHAN AND 
S.KD_BLOK=P.KD_BLOK AND 
S.NO_URUT=P.NO_URUT AND 
S.KD_JNS_OP=P.KD_JNS_OP AND 
T.THN_PAJAK_SPPT=P.THN_PAJAK_SPPT 
) 
where S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN||S.KD_KELURAHAN||S.KD_BLOK||S.NO_URUT||S.KD_JNS_OP IN ( 
332008000603000400,
332009100402800250,
332009100501500850,
332009100402000110,
332009100600501220,
332009100600501040,
332006001400200010,
332006001400200010,
332006000800601340,
332006001400200020,
332006000600401890,
332006001400200020,
332006001400200020,
332006000600501740,
332006000500300580,
332006000700700010,
332006000700200030,
332009001000200020,
332002100700901370,
332001001001000300,
332004001302502280,
332007100506400080,
332007100506400090,
332007100506400100,
332006100100800410,
332003000600501090,
332003000200500240,
332003000201600480
 
) 
 
 
ORDER BY S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'-'||S.KD_JNS_OP ASC]]>
         </code>
      </snippet>
      <snippet name="#total Tunggakan ori" description="">
         <code>
            <![CDATA[SELECT  TO_CHAR(SUM(JML_SPPT_YG_DIBAYAR)) "TOTALPENERIMAAN"
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where B.TGL_PEMBAYARAN_SPPT > TO_DATE('01-01-2014','DD-MM-YYYY') AND S.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') and
 S.STATUS_PEMBAYARAN_SPPT=1 and S.THN_PAJAK_SPPT between 2009 and 2013
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN,S.THN_PAJAK_SPPT ]]>
         </code>
      </snippet>
      <snippet name="#total tunggakan all" description="">
         <code>
            <![CDATA[SELECT  TO_CHAR(SUM(JML_SPPT_YG_DIBAYAR)) "TOTALPENERIMAAN"
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where B.TGL_PEMBAYARAN_SPPT > TO_DATE('01-01-2014','DD-MM-YYYY') AND
 S.STATUS_PEMBAYARAN_SPPT=1 and S.THN_PAJAK_SPPT between 2009 and 2013
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN,S.THN_PAJAK_SPPT ]]>
         </code>
      </snippet>
      <snippet name="#total op Baru 2009-2013" description="">
         <code>
            <![CDATA[SELECT  TO_CHAR(SUM(JML_SPPT_YG_DIBAYAR)) "TOTALPENERIMAAN"
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where B.TGL_PEMBAYARAN_SPPT > TO_DATE('01-01-2014','DD-MM-YYYY') AND S.TGL_TERBIT_SPPT > TO_DATE('01-01-2014','DD-MM-YYYY') and
 S.STATUS_PEMBAYARAN_SPPT=1 and S.THN_PAJAK_SPPT between 2009 and 2013
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN,S.THN_PAJAK_SPPT ]]>
         </code>
      </snippet>
      <snippet name="#perinciaKec" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN "KECAMATAN",L.NM_KELURAHAN "KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN "KODE",
SUM(PBB_YG_HARUS_DIBAYAR_SPPT) "POKOK",count(*) AS SPPT,S.THN_PAJAK_SPPT as TAHUN,
COUNT(DECODE (STATUS_PEMBAYARAN_SPPT, 0,1)) "SPPT-BELUM",
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "TAGIHAN",
COUNT(DECODE(STATUS_PEMBAYARAN_SPPT,1,1))"SPPT-LUNAS",
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI"
FROM SPPT S
LEFT JOIN REF_KECAMATAN K ON
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN
LEFT JOIN REF_KELURAHAN L ON
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN
WHERE  THN_PAJAK_SPPT=2014 AND S.STATUS_PEMBAYARAN_SPPT in(0,1) AND S.KD_KECAMATAN=061
GROUP BY K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN,s.THN_PAJAK_SPPT order by kode asc]]>
         </code>
      </snippet>
      <snippet name="#Urutan Desa BelumLunas UP" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE, 
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK, 
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG", 
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI", 
count(*) as JMLSPPT, 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "BELUMLUNAS", 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) "LUNAS", 
TRUNC((COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) / count(*))*100,2) AS PERSENTASE, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 5000 AND 100000 THEN 1 ELSE 0 END) AS R1, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 100001 AND 500000 THEN 1 ELSE 0 END) AS R2, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 500001 AND 1000000 THEN 1 ELSE 0 END) AS R3, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 1000001 AND 2000000 THEN 1 ELSE 0 END) AS R4, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 2000001 AND 5000000 THEN 1 ELSE 0 END) AS R5, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 5000001 AND 10000000 THEN 1 ELSE 0 END) AS R6, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 10000001 AND 25000000 THEN 1 ELSE 0 END) AS R7, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 25000001 AND 60000000 THEN 1 ELSE 0 END) AS R8, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 60000001  AND 300000000   THEN 1 ELSE 0 END) AS R9, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000  AND 100000 THEN 1500 ELSE 0 END) AS H1, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 100001  AND 500000 THEN 8000 ELSE 0 END) AS H2, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 500001  AND 1000000 THEN 25000 ELSE 0 END) AS H3, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1000001  AND 2000000 THEN 50000 ELSE 0 END) AS H4, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000001  AND 5000000 THEN 350000 ELSE 0 END) AS H5, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000001  AND 10000000 THEN 550000 ELSE 0 END) AS H6, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 10000001  AND 25000000 THEN 800000 ELSE 0 END) AS H7, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 25000001  AND 60000000 THEN 2000000 ELSE 0 END) AS H8, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT)  BETWEEN 60000001  AND 300000000 THEN 3000000 ELSE 0 END) AS H9 
FROM SPPT S  
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN pembayaran_sppt B ON ( 
S.KD_PROPINSI=B.KD_PROPINSI AND 
S.KD_DATI2=B.KD_DATI2 AND 
S.KD_KECAMATAN=B.KD_KECAMATAN AND 
S.KD_KELURAHAN=B.KD_KELURAHAN AND 
S.KD_BLOK=B.KD_BLOK AND 
S.NO_URUT=B.NO_URUT AND 
S.KD_JNS_OP=B.KD_JNS_OP AND 
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT 
) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
WHERE  S.THN_PAJAK_SPPT=2014 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1) and  
S.PBB_YG_HARUS_DIBAYAR_SPPT <300000000 AND B.TGL_PEMBAYARAN_SPPT BETWEEN TO_DATE('01-01-2014','DD-MM-YYYY') AND TO_DATE('17-11-2014','DD-MM-YYYY')   AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040018 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010014 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041014 AND 
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020009 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061013 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010015 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041009 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041015 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320100004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040014 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010017 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041013 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090008 AND
-- TAHAP 2
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010016 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010013 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090009 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090019 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040013 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320041001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061014 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061015 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061009 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030015 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030013 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030001 AND
-- TAHAP 3
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320090001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030009 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030014 AND
--TAHAP 4
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320020012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320021012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320030012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040015 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040017 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320050010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320060012 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320061010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320070001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320070006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320070007 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080001 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080009 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081008 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081009 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320081010 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091002 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091003 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091005 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091006 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320091007 AND
--tahap5
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320080004 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010009 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320010018 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071002 AND
--tahap6 
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071001 AND
--tahap7
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320040011 AND
LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320')!=3320071005 
 
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY persentase desc]]>
         </code>
      </snippet>
      <snippet name="#KODE" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD('-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN,'12','3320') AS KODE, 
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK, 
count(*) as SPPT,ROUND(count(*)/2) as PAGE,
SUM(CASE WHEN s.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 2000001 and 999999999999999 THEN 1 ELSE 0 END) "BUKU 45"

FROM SPPT S  
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
WHERE  S.THN_PAJAK_SPPT=2014 
 
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY KODE asc]]>
         </code>
      </snippet>
      <snippet name="#OCMS DENDA" description="">
         <code>
            <![CDATA[SELECT '015' as KODE,a.KD_PROPINSI||''||a.KD_DATI2|
|''||a.KD_KECAMATAN||''||a.KD_KELURAHAN||''||a.KD_BLOK||''||a.NO_URUT||''||A.KD_JNS_OP AS NOP,
a.THN_PAJAK_SPPT AS TAHUN, a.NM_WP_SPPT AS NAMA,
a.PBB_YG_HARUS_DIBAYAR_SPPT AS TAGIHAN,ROUND((a.PBB_YG_HARUS_DIBAYAR_SPPT*2)/100) as DENDA
FROM SPPT a WHERE STATUS_PEMBAYARAN_SPPT='0' and a.TGL_TERBIT_SPPT > TO_DATE('09-01-2014','DD-MM-YYYY')
AND a.THN_PAJAK_SPPT BETWEEN 2014 and 2014 and PBB_YG_HARUS_DIBAYAR_SPPT not in 0 ORDER BY
a.KD_PROPINSI||''||a.KD_DATI2||''||a.KD_KECAMATAN||''||a.KD_KELURAHAN||''||a.KD_BLOK||''||a.NO_URUT||''||A.KD_JNS_OP asc
]]>
         </code>
      </snippet>
      <snippet name="#UP PIUTANG" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE, 
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK, 
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG", 
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI", 
count(*) as JMLSPPT, 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "BELUMLUNAS", 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) "LUNAS", 
TRUNC((COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) / count(*))*100,2) AS PERSENTASE, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 5000 AND 100000 THEN 1 ELSE 0 END) AS R1, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 100001 AND 500000 THEN 1 ELSE 0 END) AS R2, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 500001 AND 1000000 THEN 1 ELSE 0 END) AS R3, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 1000001 AND 2000000 THEN 1 ELSE 0 END) AS R4, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 2000001 AND 5000000 THEN 1 ELSE 0 END) AS R5, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 5000001 AND 10000000 THEN 1 ELSE 0 END) AS R6, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 10000001 AND 25000000 THEN 1 ELSE 0 END) AS R7, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 25000001 AND 60000000 THEN 1 ELSE 0 END) AS R8, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 60000001  AND 300000000   THEN 1 ELSE 0 END) AS R9, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000  AND 100000 THEN 1500 ELSE 0 END) AS H1, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 100001  AND 500000 THEN 8000 ELSE 0 END) AS H2, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 500001  AND 1000000 THEN 25000 ELSE 0 END) AS H3, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1000001  AND 2000000 THEN 50000 ELSE 0 END) AS H4, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000001  AND 5000000 THEN 350000 ELSE 0 END) AS H5, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000001  AND 10000000 THEN 550000 ELSE 0 END) AS H6, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 10000001  AND 25000000 THEN 800000 ELSE 0 END) AS H7, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 25000001  AND 60000000 THEN 2000000 ELSE 0 END) AS H8, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT)  BETWEEN 60000001  AND 300000000 THEN 3000000 ELSE 0 END) AS H9 
FROM SPPT S  
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN pembayaran_sppt B ON ( 
S.KD_PROPINSI=B.KD_PROPINSI AND 
S.KD_DATI2=B.KD_DATI2 AND 
S.KD_KECAMATAN=B.KD_KECAMATAN AND 
S.KD_KELURAHAN=B.KD_KELURAHAN AND 
S.KD_BLOK=B.KD_BLOK AND 
S.NO_URUT=B.NO_URUT AND 
S.KD_JNS_OP=B.KD_JNS_OP AND 
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT 
) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
WHERE  S.THN_PAJAK_SPPT between 2009 and 2013 AND S.STATUS_PEMBAYARAN_SPPT IN(1) and  
S.PBB_YG_HARUS_DIBAYAR_SPPT <300000000 AND B.TGL_PEMBAYARAN_SPPT BETWEEN TO_DATE('01-01-2014','DD-MM-YYYY') AND TO_DATE('10-12-2014','DD-MM-YYYY')   AND S.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY')

GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY persentase desc]]>
         </code>
      </snippet>
      <snippet name="#DATAPENERIMAAN PER KECAMATAN" description="">
         <code>
            <![CDATA[
SELECT K.NM_KECAMATAN,'3320-'||K.KD_KECAMATAN AS KODE,B.THN_PAJAK_SPPT,
SUM(B.JML_SPPT_YG_DIBAYAR) "REALISASI TOTAL",
(SUM(B.JML_SPPT_YG_DIBAYAR)-SUM(B.DENDA_SPPT)) "REASLISASI POKOK",SUM(B.DENDA_SPPT) AS DENDA

FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where s.THN_PAJAK_SPPT BETWEEN 2009 AND 2014 and S.STATUS_PEMBAYARAN_SPPT in (0,1) AND B.TGL_PEMBAYARAN_SPPT > TO_DATE('01-01-2014','DD-MM-YYYY')
GROUP BY  K.NM_KECAMATAN,K.KD_KECAMATAN,S.THN_PAJAK_SPPT,B.THN_PAJAK_SPPT ORDER BY KODE,S.THN_PAJAK_SPPT ASC
]]>
         </code>
      </snippet>
      <snippet name="#jm-plyanan" description="">
         <code>
            <![CDATA[select j.NM_JENIS_PELAYANAN ,count(*) as from PST_detail p 
left join REF_JNS_PELAYANAN j on p.KD_JNS_PELAYANAN=j.KD_JNS_PELAYANAN 

where p.THN_PELAYANAN=2014 group by j.NM_JENIS_PELAYANAN]]>
         </code>
      </snippet>
      <snippet name="#DAFTAR PIUTANG BY NOP" description="">
         <code>
            <![CDATA[
SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP,
S.NM_WP_SPPT AS NAMA_WP,S.PBB_YG_HARUS_DIBAYAR_SPPT AS TAGIHAN,S.THN_PAJAK_SPPT "TAHUN", K.NM_KECAMATAN AS KECAMATAN,
L.NM_KELURAHAN "DESA", S.JLN_WP_SPPT||' - '||L.NM_KELURAHAN AS ALAMAT,S.LUAS_BUMI_SPPT "LUAS_BUMI",S.LUAS_BNG_SPPT "LUAS_BNG",
NVL(S.PBB_YG_HARUS_DIBAYAR_SPPT,'0') AS PBB,CASE S.STATUS_PEMBAYARAN_SPPT WHEN '0' THEN 'BELUM BAYAR' WHEN '1' THEN 'BAYAR' END AS,
 0 "KETERANGAN"
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where s.THN_PAJAK_SPPT=2014 and S.STATUS_PEMBAYARAN_SPPT in (0,1) and
S.TGL_TERBIT_SPPT<to_date('01012015','ddmmyyyy') and 
 NOT exists (select *
     from pembayaran_sppt byr
     where S.kd_propinsi = byr.kd_propinsi
       and S.kd_dati2 = byr.kd_dati2
       and S.kd_kecamatan = byr.kd_kecamatan
       and S.kd_kelurahan = byr.kd_kelurahan
       and S.kd_blok = byr.kd_blok
       and S.no_urut = byr.no_urut
       and S.kd_jns_op = byr.kd_jns_op
       and S.thn_pajak_sppt = byr.thn_pajak_sppt
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012014','DDMMYYYY') AND  to_date('31122015','DDMMYYYY'))

ORDER BY K.NM_KECAMATAN,S.KD_KELURAHAN ASC;
]]>
         </code>
      </snippet>
      <snippet name="#INSERT" description="">
         <code>
            <![CDATA[INSERT INTO TEMP_SPPT
SELECT S.KD_PROPINSI,S.KD_DATI2,S.KD_KECAMATAN,S.KD_KELURAHAN,S.KD_BLOK,S.NO_URUT,S.KD_JNS_OP,S.THN_PAJAK_SPPT,'0' FROM SPPT S WHERE
S.THN_PAJAK_SPPT=2014 AND (S.NM_WP_SPPT LIKE '%HUTCH%'  OR
S.NM_WP_SPPT LIKE '%TOWER%'  OR
S.NM_WP_SPPT LIKE '%KOMUNIKASI%'  OR
S.NM_WP_SPPT LIKE '%BTS%'  OR
S.NM_WP_SPPT LIKE '%INDOSAT%' OR
S.NM_WP_SPPT LIKE '%NATRINDO TELEPON%' OR
S.NM_WP_SPPT LIKE '%TELKOMSEL%' OR
S.NM_WP_SPPT LIKE '%METROSEL%' OR
S.NM_WP_SPPT LIKE '%XL AXIATA%' OR
S.NM_WP_SPPT LIKE '%PT EXCELCOMINDO PRATAMA TBK%'  OR 
S.NM_WP_SPPT LIKE '%SWASTATIKA SENTOSA%'  OR
S.NM_WP_SPPT LIKE '%PT. AXIS TELEPON SELULER%'  OR
S.NM_WP_SPPT LIKE '%PT. Solusindo Kreasi Pratama (TBG%'  OR
S.NM_WP_SPPT LIKE '%TOWER BERSAMA%'  OR
S.NM_WP_SPPT LIKE '%PT. DAYAMITRA TELEKOMUNIKASI%'  OR
S.NM_WP_SPPT LIKE '%PT. PERSADA SOKKA TAMA%'  OR
S.NM_WP_SPPT LIKE '%PT. RETOWER ASIA%'  OR
S.NM_WP_SPPT LIKE '%PT. PERSADA SOKKA TAMA%'  OR
S.NM_WP_SPPT LIKE '%PT ERA BANGUN JAYA%'  OR
S.NM_WP_SPPT LIKE '%PT. Bangun Andalan Perkasa%'  OR
S.NM_WP_SPPT LIKE '%PT RTM VIDITRA PRATAMA%'  OR
S.NM_WP_SPPT LIKE '%PT LINGGA JATI AL MANSHURIN%'  OR
S.NM_WP_SPPT LIKE '%PT. NARAGITA DINAMIKA KOMUNIKA%'  OR
S.NM_WP_SPPT LIKE '%Protelindo%' OR
S.NM_WP_SPPT LIKE '%PLN%')

UPDATE TEMP_SPPT SET STATUS_SPPT='0'
]]>
         </code>
      </snippet>
      <snippet name="#PTG-5YR" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN,AA.KD_PROPINSI||'.'||AA.KD_DATI2||'.'||AA.KD_KECAMATAN||'.'||AA.KD_KELURAHAN||' - '||AA.NM_KELURAHAN KELURAHAN,
A.JML SPPT2009, A.PBB PBB2009,
B.JML SPPT2010, B.PBB PBB2010,
C.JML SPPT2011, C.PBB PBB2011,
D.JML SPPT2012, D.PBB PBB2012,
E.JML SPPT2013, E.PBB PBB2013,
F.JML SPPT2014, F.PBB PBB2014
FROM
REF_KELURAHAN AA,REF_KECAMATAN K,
(SELECT KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN, COUNT(*) JML, SUM(PBB_YG_HARUS_DIBAYAR_SPPT) PBB FROM SPPT WHERE THN_PAJAK_SPPT='2009' AND STATUS_PEMBAYARAN_SPPT='0'  AND TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') GROUP BY KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN) A,
(SELECT KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN,  COUNT(*) JML, SUM(PBB_YG_HARUS_DIBAYAR_SPPT) PBB FROM SPPT WHERE THN_PAJAK_SPPT='2010' AND STATUS_PEMBAYARAN_SPPT='0' AND TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') GROUP BY KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN) B,
(SELECT KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN, COUNT(*) JML, SUM(PBB_YG_HARUS_DIBAYAR_SPPT) PBB FROM SPPT WHERE THN_PAJAK_SPPT='2011' AND STATUS_PEMBAYARAN_SPPT='0'  AND TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') GROUP BY KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN) C,
(SELECT KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN,  COUNT(*) JML, SUM(PBB_YG_HARUS_DIBAYAR_SPPT) PBB FROM SPPT WHERE THN_PAJAK_SPPT='2012' AND STATUS_PEMBAYARAN_SPPT='0' AND TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') GROUP BY KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN) D,
(SELECT KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN, COUNT(*) JML, SUM(PBB_YG_HARUS_DIBAYAR_SPPT) PBB  FROM SPPT WHERE THN_PAJAK_SPPT='2013' AND STATUS_PEMBAYARAN_SPPT='0' AND TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') GROUP BY KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN) E,
(SELECT KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN, COUNT(*) JML, SUM(PBB_YG_HARUS_DIBAYAR_SPPT) PBB FROM SPPT WHERE THN_PAJAK_SPPT='2014' AND STATUS_PEMBAYARAN_SPPT='0' GROUP BY KD_PROPINSI, KD_DATI2, KD_KECAMATAN, KD_KELURAHAN) F
WHERE
AA.KD_KECAMATAN=K.KD_KECAMATAN (+) 
AND AA.KD_PROPINSI = A.KD_PROPINSI (+)
AND AA.KD_DATI2 = A.KD_DATI2 (+)
AND AA.KD_KECAMATAN = A.KD_KECAMATAN (+)
AND AA.KD_KELURAHAN = A.KD_KELURAHAN (+)
AND AA.KD_PROPINSI = B.KD_PROPINSI (+)
AND AA.KD_DATI2 = B.KD_DATI2 (+)
AND AA.KD_KECAMATAN = B.KD_KECAMATAN (+)
AND AA.KD_KELURAHAN = B.KD_KELURAHAN (+)
AND AA.KD_PROPINSI = C.KD_PROPINSI (+)
AND AA.KD_DATI2 = C.KD_DATI2 (+)
AND AA.KD_KECAMATAN = C.KD_KECAMATAN (+)
AND AA.KD_KELURAHAN = C.KD_KELURAHAN (+)
AND AA.KD_PROPINSI = D.KD_PROPINSI (+)
AND AA.KD_DATI2 = D.KD_DATI2 (+)
AND AA.KD_KECAMATAN = D.KD_KECAMATAN (+)
AND AA.KD_KELURAHAN = D.KD_KELURAHAN (+)
AND AA.KD_PROPINSI = E.KD_PROPINSI (+)
AND AA.KD_DATI2 = E.KD_DATI2 (+)
AND AA.KD_KECAMATAN = E.KD_KECAMATAN (+)
AND AA.KD_KELURAHAN = E.KD_KELURAHAN (+)
AND AA.KD_PROPINSI = F.KD_PROPINSI (+)
AND AA.KD_DATI2 = F.KD_DATI2 (+)
AND AA.KD_KECAMATAN = F.KD_KECAMATAN (+)
AND AA.KD_KELURAHAN = F.KD_KELURAHAN (+)
ORDER BY KELURAHAN ASC]]>
         </code>
      </snippet>
      <snippet name="#DATAPENERIMAAN PIUTANG PER TAHUN" description="">
         <code>
            <![CDATA[SELECT  S.THN_PAJAK_SPPT,
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI",COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) "WP"
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where S.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') AND B.TGL_PEMBAYARAN_SPPT > TO_DATE('01-01-2014','DD-MM-YYYY') AND
 S.STATUS_PEMBAYARAN_SPPT=1 AND B.THN_PAJAK_SPPT BETWEEN 2009 AND 2013
GROUP BY S.THN_PAJAK_SPPT ORDER BY S.THN_PAJAK_SPPT ASC]]>
         </code>
      </snippet>
      <snippet name="#DATA PENERIMAAN PIUTANG ALL BY NOP" description="">
         <code>
            <![CDATA[SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP,S.THN_PAJAK_SPPT "TAHUN",  
S.NM_WP_SPPT "NAMA WAJIB PAJAK",S.PBB_YG_HARUS_DIBAYAR_SPPT "POKOK BAYAR",B.DENDA_SPPT "DENDA",B.JML_SPPT_YG_DIBAYAR "PBB YG BAYAR", K.NM_KECAMATAN AS KECAMATAN,  
L.NM_KELURAHAN "DESA/KELURAHAN", S.JLN_WP_SPPT||' - '||L.NM_KELURAHAN AS ALAMAT,S.LUAS_BUMI_SPPT "LUAS_BUMI",S.LUAS_BNG_SPPT "LUAS_BNG",  
CASE S.STATUS_PEMBAYARAN_SPPT WHEN '0' THEN 'BELUM BAYAR' WHEN '1' THEN 'BAYAR' END "STATUS BAYAR",nvl(TO_CHAR(B.TGL_PEMBAYARAN_SPPT,'YYYY-MM-DD'),'0000-01-01') "TANGGAL BAYAR", 0 "KETERANGAN"  
FROM SPPT S   
LEFT JOIN pembayaran_sppt B ON (  
S.KD_PROPINSI=B.KD_PROPINSI AND  
S.KD_DATI2=B.KD_DATI2 AND  
S.KD_KECAMATAN=B.KD_KECAMATAN AND  
S.KD_KELURAHAN=B.KD_KELURAHAN AND  
S.KD_BLOK=B.KD_BLOK AND  
S.NO_URUT=B.NO_URUT AND  
S.KD_JNS_OP=B.KD_JNS_OP AND  
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT  
)  
LEFT JOIN REF_KECAMATAN K ON (  
S.KD_PROPINSI=K.KD_PROPINSI AND  
S.KD_DATI2=K.KD_DATI2 AND  
S.KD_KECAMATAN=K.KD_KECAMATAN )  
LEFT JOIN REF_KELURAHAN L ON (  
S.KD_PROPINSI=L.KD_PROPINSI AND  
S.KD_DATI2=L.KD_DATI2 AND  
S.KD_KECAMATAN=L.KD_KECAMATAN AND  
S.KD_KELURAHAN=L.KD_KELURAHAN )  
where s.THN_PAJAK_SPPT=2014 and S.STATUS_PEMBAYARAN_SPPT in (0,1) and  
S.TGL_TERBIT_SPPT<to_date('01012015','ddmmyyyy') and   
  exists (select *  
     from pembayaran_sppt byr  
     where S.kd_propinsi = byr.kd_propinsi  
       and S.kd_dati2 = byr.kd_dati2  
       and S.kd_kecamatan = byr.kd_kecamatan  
       and S.kd_kelurahan = byr.kd_kelurahan  
       and S.kd_blok = byr.kd_blok  
       and S.no_urut = byr.no_urut  
       and S.kd_jns_op = byr.kd_jns_op  
       and S.thn_pajak_sppt = byr.thn_pajak_sppt  
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012015','DDMMYYYY') AND  to_date('31122015','DDMMYYYY'))  
  
ORDER BY K.NM_KECAMATAN,S.KD_KELURAHAN ASC]]>
         </code>
      </snippet>
      <snippet name="#DATADAFTAR REKAP PIUTANG VALID" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN AS KECAMATAN,L.NM_KELURAHAN "DESA-KELURAHAN",'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN AS KODE,T.THN_PAJAK_SPPT AS TAHUN, 
SUM(T.PBB_YG_HARUS_DIBAYAR_SPPT) AS PIUTANG,COUNT(*) AS WP 
FROM DAT_OBJEK_PAJAK S    
LEFT JOIN DAT_SUBJEK_PAJAK B ON (   
S.SUBJEK_PAJAK_ID=B.SUBJEK_PAJAK_ID    
)   
LEFT JOIN SPPT T ON (   
S.KD_PROPINSI=T.KD_PROPINSI AND   
S.KD_DATI2=T.KD_DATI2 AND   
S.KD_KECAMATAN=T.KD_KECAMATAN AND   
S.KD_KELURAHAN=T.KD_KELURAHAN AND   
S.KD_BLOK=T.KD_BLOK AND   
S.NO_URUT=T.NO_URUT AND   
S.KD_JNS_OP=T.KD_JNS_OP    
)   
LEFT JOIN KELAS_TANAH H ON (    
T.KD_KLS_TANAH=H.KD_KLS_TANAH   
)   
LEFT JOIN KELAS_BANGUNAN N ON (    
T.KD_KLS_BNG=N.KD_KLS_BNG    
)   
LEFT JOIN DAT_OP_BUMI D ON (    
S.KD_PROPINSI=D.KD_PROPINSI AND   
S.KD_DATI2=D.KD_DATI2 AND   
S.KD_KECAMATAN=D.KD_KECAMATAN AND   
S.KD_KELURAHAN=D.KD_KELURAHAN AND   
S.KD_BLOK=D.KD_BLOK AND   
S.NO_URUT=D.NO_URUT AND   
S.KD_JNS_OP=D.KD_JNS_OP    
)   
LEFT JOIN REF_KECAMATAN K ON (   
S.KD_PROPINSI=K.KD_PROPINSI AND   
S.KD_DATI2=K.KD_DATI2 AND   
S.KD_KECAMATAN=K.KD_KECAMATAN )   
LEFT JOIN REF_KELURAHAN L ON (   
S.KD_PROPINSI=L.KD_PROPINSI AND   
S.KD_DATI2=L.KD_DATI2 AND   
S.KD_KECAMATAN=L.KD_KECAMATAN AND   
S.KD_KELURAHAN=L.KD_KELURAHAN )   
WHERE  
( 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060004' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320040009' AND T.THN_PAJAK_SPPT IN (2013,2012,2011) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320070005' AND T.THN_PAJAK_SPPT IN (2013,2012) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320020005' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320040016' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320050001' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320020006' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320061004' AND T.THN_PAJAK_SPPT IN (2013,2012,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320021007' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320061008' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320061003' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060016' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320070008' AND T.THN_PAJAK_SPPT IN (2013) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060015' AND T.THN_PAJAK_SPPT IN (2013) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060014' AND T.THN_PAJAK_SPPT IN (2013,2012,2010) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320070003' AND T.THN_PAJAK_SPPT IN (2013) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320061002' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060008' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060009' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060006' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060007' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060003' AND T.THN_PAJAK_SPPT IN (2012,2010) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320021009' AND T.THN_PAJAK_SPPT IN (2012,2011,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060001' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320060011' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320040004' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320040001' AND T.THN_PAJAK_SPPT IN (2013,2012,2011,2010,2009) OR 
'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN='3320040017' AND T.THN_PAJAK_SPPT IN (2012)  

 
) 
 and not exists (select *
     from pembayaran_sppt byr
     where T.kd_propinsi = byr.kd_propinsi
       and T.kd_dati2 = byr.kd_dati2
       and T.kd_kecamatan = byr.kd_kecamatan
       and T.kd_kelurahan = byr.kd_kelurahan
       and T.kd_blok = byr.kd_blok
       and T.no_urut = byr.no_urut
       and T.kd_jns_op = byr.kd_jns_op
       and T.thn_pajak_sppt = byr.thn_pajak_sppt
       and byr.tgl_pembayaran_sppt < to_date('01012015','DDMMYYYY'))
AND T.STATUS_PEMBAYARAN_SPPT in (0,1) AND T.TGL_TERBIT_SPPT < TO_DATE('01-01-2014','DD-MM-YYYY') 
GROUP BY K.NM_KECAMATAN,L.NM_KELURAHAN,T.THN_PAJAK_SPPT,'3320'||K.KD_KECAMATAN||L.KD_KELURAHAN   
ORDER BY '3320'||K.KD_KECAMATAN||L.KD_KELURAHAN,TAHUN ASC






]]>
         </code>
      </snippet>
      <snippet name="#DATAPENEREMIAAN PIUTANG PER DESA-VER" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN "KECAMATAN",L.NM_KELURAHAN "DESA/KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN AS KODE,S.THN_PAJAK_SPPT AS TAHUN,
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) "POKOK",count(*) AS SPPT,
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT<=to_date('04052015','ddmmyyyy')) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) AS REALISASI,
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT<=to_date('04052015','ddmmyyyy')) THEN 1 ELSE 0 END) "LUNAS SPPT"

--COUNT(DECODE(S.STATUS_PEMBAYARAN_SPPT,1,1))"SPPT-LUNAS",
--COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "SPPT-BELUM",
--SUM(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "TAGIHAN",
--(SUM(B.JML_SPPT_YG_DIBAYAR)-SUM(B.DENDA_SPPT)) "REASLISASI POKOK",SUM(B.DENDA_SPPT) AS DENDA,
--SUM(B.JML_SPPT_YG_DIBAYAR) "REALISASI TOTAL"

FROM SPPT S 
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
where s.THN_PAJAK_SPPT=2015 and S.STATUS_PEMBAYARAN_SPPT in (0,1) and S.KD_KECAMATAN=100
GROUP BY  K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN,S.THN_PAJAK_SPPT ORDER BY KODE,S.THN_PAJAK_SPPT ASC
]]>
         </code>
      </snippet>
      <snippet name="#lockproses" description="">
         <code>
            <![CDATA[select vs.audsid audsid,
 locks.sid sid,
 vs.serial# serial#,
 vs.username oracle_user,
 vs.osuser os_user,
 vs.program program,
 vs.module module,
 vs.action action,
 vs.process process,
 decode(locks.lmode,
       1, NULL,
       2, 'Row Share',
       3, 'Row Exclusive',
       4, 'Share',
       5, 'Share Row Exclusive',
       6, 'Exclusive', 'None') lock_mode_held,
 decode(locks.request,
       1, NULL,
       2, 'Row Share',
       3, 'Row Exclusive',
       4, 'Share',
       5, 'Share Row Exclusive',
       6, 'Exclusive', 'None') lock_mode_requested,
 decode(locks.type,
       'MR', 'Media Recovery',
       'RT', 'Redo Thread',
       'UN', 'User Name',
       'TX', 'Transaction',
       'TM', 'DML',
       'UL', 'PL/SQL User Lock',
       'DX', 'Distributed Xaction',
       'CF', 'Control File',
       'IS', 'Instance State',
       'FS', 'File Set',
       'IR', 'Instance Recovery',
       'ST', 'Disk Space Transaction',
       'TS', 'Temp Segment',
       'IV', 'Library Cache Invalidation',
       'LS', 'Log Start or Log Switch',
       'RW', 'Row Wait',
       'SQ', 'Sequence Number',
       'TE', 'Extend Table',
       'TT', 'Temp Table',
       locks.type) lock_type,
 objs.owner object_owner,
 objs.object_name object_name,
 objs.object_type object_type,
 round( locks.ctime/60, 2 ) lock_time_in_minutes
from v$session vs,
         v$lock locks,
         dba_objects objs,
         dba_tables tbls
where locks.id1 = objs.object_id
 and vs.sid = locks.sid
 and objs.owner = tbls.owner
 and objs.object_name =  tbls.table_name
 and objs.owner != 'SYS'
 and locks.type = 'TM'
 order by lock_time_in_minutes;

* setelah keliatan user mana yang ngelock.. catat SID, dan SERIAL# nya.. lalu lakukan kill process dengan query berikut :

alter system kill session '4,201' immediate;
alter system kill session '419,155' immediate;

]]>
         </code>
      </snippet>
      <snippet name="#OBJEK MURNI" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN "KECAMATAN",L.NM_KELURAHAN "KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN "KODE",
count(*) AS SPPT FROM DAT_OBJEK_PAJAK S
LEFT JOIN DAT_SUBJEK_PAJAK B ON (
S.SUBJEK_PAJAK_ID=B.SUBJEK_PAJAK_ID 
)
LEFT JOIN DAT_OP_BUMI D ON ( 
S.KD_PROPINSI=D.KD_PROPINSI AND
S.KD_DATI2=D.KD_DATI2 AND
S.KD_KECAMATAN=D.KD_KECAMATAN AND
S.KD_KELURAHAN=D.KD_KELURAHAN AND
S.KD_BLOK=D.KD_BLOK AND
S.NO_URUT=D.NO_URUT AND
S.KD_JNS_OP=D.KD_JNS_OP 
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN
)
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN
)
WHERE B.NM_WP NOT IN ('GBG')  
GROUP BY K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN order by kode asc]]>
         </code>
      </snippet>
      <snippet name="#REKLASZNT" description="">
         <code>
            <![CDATA[DECLARE
  CURSOR C1 IS SELECT * FROM DAT_OP_BUMI WHERE KD_ZNT='31';
BEGIN
  FOR R1 IN C1 LOOP
    BEGIN
     INSERT INTO DAT_PETA_ZNT VALUES(R1.KD_PROPINSI,R1.KD_DATI2,R1.KD_KECAMATAN,R1.KD_KELURAHAN,R1.KD_BLOK,'30');
    EXCEPTION WHEN OTHERS THEN NULL;
    END;
   
    UPDATE DAT_OP_BUMI SET KD_ZNT='30'
    WHERE KD_PROPINSI=R1.KD_PROPINSI AND
      KD_DATI2=R1.KD_DATI2 AND
      KD_KECAMATAN=R1.KD_KECAMATAN AND
      KD_KELURAHAN=R1.KD_KELURAHAN AND
      KD_BLOK=R1.KD_BLOK AND
      NO_URUT=R1.NO_URUT AND
      KD_JNS_OP=R1.KD_JNS_OP;
    COMMIT;
  END LOOP;
END;]]>
         </code>
      </snippet>
      <snippet name="#DAFNOM" description="">
         <code>
            <![CDATA[SELECT * FROM DAFNOM_OP WHERE KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP in (
332007000702200250

);

update DAFNOM_OP set KATEGORI_OP=4 where KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP in (
332007000702200250

);]]>
         </code>
      </snippet>
      <snippet name="#Dup-paymnet" description="">
         <code>
            <![CDATA[SELECT * from PEMBAYARAN_SPPT S
 where S.THN_PAJAK_SPPT=2012 AND  exists (select * from PEMBAYARAN_SPPT S2
                 where
                  S2.KD_PROPINSI = S.KD_PROPINSI
                   and S2.KD_DATI2 = S.KD_DATI2
                   AND S2.KD_KECAMATAN = S.KD_KECAMATAN
                   AND S2.KD_KELURAHAN = S.KD_KELURAHAN
                   AND S2.KD_BLOK = S.KD_BLOK
                   AND S2.NO_URUT = S.NO_URUT
                   AND S2.KD_JNS_OP = S.KD_JNS_OP
                  AND S2.THN_PAJAK_SPPT = S.THN_PAJAK_SPPT
                   and S2.rowid      > S.rowid );]]>
         </code>
      </snippet>
      <snippet name="#DATA PIUTANG BY NOP" description="">
         <code>
            <![CDATA[
SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP,S.THN_PAJAK_SPPT "TAHUN",
S.NM_WP_SPPT "NAMA WAJIB PAJAK",NVL(S.PBB_YG_HARUS_DIBAYAR_SPPT,'0') AS TAGIHAN, K.NM_KECAMATAN AS KECAMATAN,
L.NM_KELURAHAN "DESA/KELURAHAN", S.JLN_WP_SPPT||' - '||L.NM_KELURAHAN AS ALAMAT,S.LUAS_BUMI_SPPT "LUAS_BUMI",S.LUAS_BNG_SPPT "LUAS_BNG"
,CASE S.STATUS_PEMBAYARAN_SPPT WHEN '0' THEN 'BELUM BAYAR' WHEN '1' THEN 'BAYAR' END "STATUS BAYAR",
 0 "KETERANGAN"
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where s.THN_PAJAK_SPPT=2014 and S.STATUS_PEMBAYARAN_SPPT in (0,1) and
S.TGL_TERBIT_SPPT<to_date('01012015','ddmmyyyy') and 
 NOT exists (select *
     from pembayaran_sppt byr
     where S.kd_propinsi = byr.kd_propinsi
       and S.kd_dati2 = byr.kd_dati2
       and S.kd_kecamatan = byr.kd_kecamatan
       and S.kd_kelurahan = byr.kd_kelurahan
       and S.kd_blok = byr.kd_blok
       and S.no_urut = byr.no_urut
       and S.kd_jns_op = byr.kd_jns_op
       and S.thn_pajak_sppt = byr.thn_pajak_sppt
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012014','DDMMYYYY') AND  to_date('31122015','DDMMYYYY'))

ORDER BY K.NM_KECAMATAN,S.KD_KELURAHAN ASC;
]]>
         </code>
      </snippet>
      <snippet name="#GBG" description="">
         <code>
            <![CDATA[SELECT * FROM SPPT WHERE KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP in (
332004001401200120

) and STATUS_PEMBAYARAN_SPPT=0;

update sppt set STATUS_PEMBAYARAN_SPPT=2 where KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP in (
332004001401200120

) and STATUS_PEMBAYARAN_SPPT=0;]]>
         </code>
      </snippet>
      <snippet name="#KTP NOT USE" description="">
         <code>
            <![CDATA[SELECT * FROM DAT_SUBJEK_PAJAK S WHERE NOT EXISTS ( SELECT * FROM DAT_OBJEK_PAJAK D WHERE D.SUBJEK_PAJAK_ID=S.SUBJEK_PAJAK_ID) AND S.NM_WP LIKE '%ASROFAH%']]>
         </code>
      </snippet>
      <snippet name="#formulir same" description="">
         <code>
            <![CDATA[SELECT * FROM DAT_OBJEK_PAJAK d WHERE 
EXISTS (SELECT * FROM DAT_OBJEK_PAJAK p where d.NO_FORMULIR_SPOP=p.NO_FORMULIR_SPOP   and d.rowid      > p.rowid    )]]>
         </code>
      </snippet>
      <snippet name="#JAMBU2013PIUTANGSQL" description="">
         <code>
            <![CDATA[SELECT  S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN||S.KD_KELURAHAN||S.KD_BLOK||S.NO_URUT||S.KD_JNS_OP,S.PBB_YG_HARUS_DIBAYAR_SPPT
FROM SPPT S WHERE  S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN||S.KD_KELURAHAN||S.KD_BLOK||S.NO_URUT||S.KD_JNS_OP IN (
332007000400100650,
332007000400300020,
332007000400300080,
332007000400300170,
332007000400300180,
332007000400700660,
332007000400700860,
332007000403300490,
332007000403300620,
332007000403300690,
332007000403300980,
332007000403400430,
332007000403400530,
332007000403400590,
332007000403500470,
332007000400300040,
332007000400300260,
332007000400500400,
332007000400501480,
332007000400501540,
332007000400501720,
332007000400501730,
332007000400600120,
332007000400600140,
332007000400600420,
332007000400700080,
332007000400700330,
332007000400700500,
332007000400800040,
332007000400800150,
332007000401601280,
332007000401601300,
332007000401602600,
332007000401700380,
332007000401700760,
332007000401701150,
332007000401800020,
332007000401800270,
332007000401800360,
332007000401800450,
332007000401800480,
332007000401800520,
332007000401800640,
332007000401800870,
332007000401800890,
332007000401800900,
332007000401800910,
332007000401800920,
332007000401800960,
332007000401801030,
332007000401900090,
332007000401900150,
332007000401900230,
332007000401900300,
332007000401900640,
332007000401900680,
332007000401900720,
332007000401900830,
332007000401900940,
332007000401901040,
332007000402000070,
332007000402000280,
332007000402000350,
332007000402000360,
332007000402000460,
332007000402000560,
332007000402000570,
332007000402000760,
332007000402000900,
332007000402001220,
332007000402001540,
332007000402001600,
332007000402001610,
332007000402100390,
332007000402100660,
332007000402100870,
332007000402101170,
332007000402200410,
332007000402201760,
332007000402800710,
332007000402801210,
332007000403300530,
332007000403701100,
332007000403900360,
332007000403900620,
332007000403901170,
332007000403901540,
332007000403901670,
332007000403901690,
332007000403902340,
332007000400500950,
332007000400600470,
332007000400600590,
332007000400600730,
332007000400600770,
332007000400700030,
332007000400700970,
332007000400701370,
332007000400701640,
332007000400800080,
332007000400800280,
332007000400800290,
332007000400800300,
332007000400800310,
332007000400800320,
332007000400800330,
332007000400800340,
332007000401500710,
332007000401601260,
332007000402000320,
332007000402300020,
332007000402300090,
332007000402300100,
332007000402300790,
332007000400200580,
332007000400300010,
332007000400300200,
332007000400500050,
332007000400500061,
332007000400501080,
332007000400900160,
332007000400900280,
332007000400900770,
332007000401000290,
332007000402000470,
332007000402201450,
332007000402800090,
332007000402800250,
332007000402800260,
332007000402800350,
332007000402800420,
332007000402800510,
332007000402800520,
332007000402800530,
332007000402800630,
332007000403300140,
332007000403300180,
332007000403300290,
332007000403300300,
332007000403300480,
332007000403400020,
332007000403400070,
332007000403400080,
332007000403400100,
332007000403902480,
332007000402700050,
332007000403300160,
332007000402200080,
332007000402200100,
332007000402200580,
332007000402201510,
332007000402700410,
332007000402800880,
332007000402800910,
332007000402801040,
332007000403301260,
332007000403301620,
332007000403901020,
332007000400100020,
332007000400200590,
332007000400400030,
332007000400501290,
332007000400600100,
332007000400600180,
332007000400600200,
332007000400600330,
332007000400600490,
332007000400600500,
332007000400600510,
332007000400900320,
332007000401601230,
332007000403700170,
332007000403701580,
332007000403701720,
332007000403901610,
332007000400100700,
332007000400500070,
332007000400601040,
332007000400700460,
332007000400700470,
332007000400700480,
332007000400700700,
332007000400700710,
332007000400700870,
332007000400701290,
332007000400701770,
332007000400900830,
332007000401100170,
332007000401100600,
332007000401100610,
332007000401100980,
332007000401200720,
332007000401200910,
332007000401201050,
332007000401201100,
332007000401201210,
332007000401201380,
332007000401400010,
332007000401400020,
332007000401400040,
332007000401400050,
332007000401400060,
332007000401400070,
332007000401400080,
332007000401400100,
332007000401400110,
332007000401400120,
332007000401400130,
332007000401400150,
332007000401400160,
332007000401400170,
332007000401400180,
332007000401400190,
332007000401400200,
332007000401400210,
332007000401400230,
332007000401400250,
332007000401400270,
332007000401400280,
332007000401400290,
332007000401400300,
332007000401400310,
332007000401400320,
332007000401400330,
332007000401400340,
332007000401400350,
332007000401400360,
332007000401400370,
332007000401400380,
332007000401400390,
332007000401400400,
332007000401400410,
332007000401400420,
332007000401400430,
332007000401400440,
332007000401400460,
332007000401400470,
332007000401400480,
332007000401400510,
332007000401400520,
332007000401400530,
332007000401400540,
332007000401400550,
332007000401400560,
332007000401400570,
332007000401400580,
332007000401400590,
332007000401400600,
332007000401400610,
332007000401400620,
332007000401400630,
332007000401400640,
332007000401400650,
332007000401400660,
332007000401400670,
332007000400600340,
332007000400600380,
332007000400600390,
332007000400600860,
332007000400600930,
332007000400601050,
332007000400601070,
332007000400700650,
332007000400700680,
332007000400700880,
332007000400701230,
332007000400701460,
332007000400900620,
332007000401000440,
332007000401001340,
332007000401101190,
332007000401101390,
332007000401200740,
332007000401200930,
332007000401300010,
332007000401300020,
332007000401300030,
332007000401300040,
332007000401300050,
332007000401300060,
332007000401300070,
332007000401300080,
332007000401300090,
332007000401300100,
332007000401300110,
332007000401300120,
332007000401300130,
332007000401300140,
332007000401300400,
332007000401300410,
332007000401300420,
332007000401300430,
332007000401300440,
332007000401300450,
332007000401300460,
332007000401300470,
332007000401300480,
332007000401300490,
332007000401300500,
332007000401300520,
332007000401300530,
332007000401300540,
332007000401300550,
332007000401300560,
332007000401300570,
332007000401300580,
332007000401300590,
332007000401300600,
332007000401300610,
332007000401300620,
332007000401300630,
332007000401300640,
332007000401300650,
332007000401300660,
332007000401300800,
332007000401300910,
332007000401300990,
332007000401301000,
332007000401301010,
332007000401301020,
332007000401301030,
332007000400100030,
332007000400100130,
332007000400100150,
332007000400100490,
332007000400100670,
332007000400200080,
332007000400200090,
332007000400200570,
332007000400200610,
332007000400200620,
332007000400500100,
332007000400600040,
332007000400600400,
332007000400600640,
332007000400600650,
332007000400600660,
332007000400600680,
332007000400600700,
332007000400600710,
332007000400600720,
332007000400600790,
332007000400600990,
332007000400601010,
332007000400601290,
332007000400700020,
332007000400700130,
332007000400700230,
332007000400700820,
332007000400700890,
332007000400701750,
332007000400701820,
332007000400800380,
332007000400900640,
332007000401000890,
332007000401100080,
332007000401100270,
332007000401100970,
332007000401201180,
332007000401201190,
332007000401201200,
332007000401201230,
332007000401201240,
332007000401201250,
332007000401201260,
332007000401201280,
332007000401201330,
332007000401400240,
332007000401400450,
332007000401500010,
332007000401500020,
332007000400600410,
332007000400600780,
332007000400600800,
332007000400700010,
332007000400700670,
332007000401001030,
332007000401101350,
332007000401201290,
332007000401500190,
332007000401500490,
332007000401500520,
332007000401500570,
332007000401500590,
332007000401500600,
332007000401500630,
332007000401500670,
332007000401500680,
332007000401500740,
332007000401500820,
332007000401500920,
332007000401501100,
332007000401501190,
332007000401501220,
332007000401501280,
332007000401501360,
332007000401600080,
332007000401600200,
332007000401600210,
332007000401600300,
332007000401600320,
332007000401600330,
332007000401600340,
332007000401600410,
332007000401600430,
332007000401600460,
332007000401600480,
332007000401600500,
332007000401600570,
332007000401600630,
332007000401600640,
332007000401600700,
332007000401600720,
332007000401600760,
332007000401600960,
332007000401601080,
332007000401601130,
332007000401601440,
332007000401601480,
332007000401601720,
332007000401601750,
332007000401601920,
332007000401602070,
332007000401602140,
332007000401602150,
332007000401602210,
332007000401602260,
332007000401602390,
332007000401602400,
332007000401602480,
332007000401602540,
332007000401602560,
332007000401602730,
332007000401602890,
332007000401700130,
332007000402100690,
332007000402100760,
332007000402100910,
332007000402200130,
332007000402200570,
332007000402200590,
332007000402401400,
332007000402700450,
332007000403800120,
332007000403800260,
332007000403900400,
332007000403902210,
332007000400300030,
332007000400501190,
332007000400600290,
332007000400600910,
332007000400601170,
332007000400601350,
332007000400700720,
332007000400700900,
332007000400700910,
332007000400701010,
332007000400701540,
332007000400701810,
332007000400900130,
332007000400900260,
332007000400900390,
332007000400900850,
332007000401200130,
332007000401201000,
332007000401500930,
332007000401600680,
332007000401900290,
332007000402001500,
332007000402100680,
332007000402700310,
332007000402801820,
332007000403200500,
332007000403200520,
332007000403400830,
332007000403500310,
332007000403600660,
332007000403700210,
332007000403700240,
332007000403701110,
332007000403701170,
332007000403701230,
332007000403701560,
332007000403800140,
332007000403900020,
332007000403900040,
332007000403900470,
332007000403901040,
332007000403901050,
332007000403902750,
332007000400100660,
332007000400400040,
332007000403900820,
332007000401201340,
332007000400501510,
332007000400501750,
332007000403800100,
332007000402501460,
332007000402501470,
332007000402501480,
332007000403000840,
332007000403200230,
332007000403700380,
332007000403900180,
332007000403900540,
332007000400600050,
332007000400700680,
332007000400400010
)
AND
S.THN_PAJAK_SPPT=2013 AND (S.STATUS_PEMBAYARAN_SPPT=0 OR  EXISTS
(SELECT * FROM PEMBAYARAN_SPPT P WHERE
S.KD_PROPINSI=P.KD_PROPINSI AND   
S.KD_DATI2=P.KD_DATI2 AND   
S.KD_KECAMATAN=P.KD_KECAMATAN AND   
S.KD_KELURAHAN=P.KD_KELURAHAN AND   
S.KD_BLOK=P.KD_BLOK AND   
S.NO_URUT=P.NO_URUT AND   
S.KD_JNS_OP=P.KD_JNS_OP AND
S.THN_PAJAK_SPPT=P.THN_PAJAK_SPPT AND
P.TGL_PEMBAYARAN_SPPT<TO_DATE('01012014','DDMMYYYY')
));

]]>
         </code>
      </snippet>
      <snippet name="#NIR-PER-KELR" description="">
         <code>
            <![CDATA[select distinct op.kd_propinsi, op.kd_dati2, op.kd_kecamatan, op.kd_kelurahan, op.kd_blok, op.jalan_op, bumi.kd_znt,
  (nir.nir * 1000) as nir
  
from dat_objek_pajak op, dat_op_bumi bumi, dat_nir nir, kelas_tanah, ref_kecamatan kec, ref_kelurahan kel

where nir.thn_nir_znt = '2015'
  and op.kd_kecamatan= '060'
  and op.kd_kelurahan = '001'
  
  and op.kd_propinsi = bumi.kd_propinsi
  and op.kd_dati2 = bumi.kd_dati2
  and op.kd_kecamatan = bumi.kd_kecamatan
  and op.kd_kelurahan = bumi.kd_kelurahan
  and op.kd_blok = bumi.kd_blok
  and op.no_urut = bumi.no_urut
  and op.kd_jns_op = bumi.kd_jns_op

  and op.kd_propinsi = nir.kd_propinsi
  and op.kd_dati2 = nir.kd_dati2
  and op.kd_kecamatan = nir.kd_kecamatan
  and op.kd_kelurahan = nir.kd_kelurahan
  and bumi.kd_propinsi = nir.kd_propinsi
  and bumi.kd_dati2 = nir.kd_dati2
  and bumi.kd_kecamatan = nir.kd_kecamatan
  and bumi.kd_kelurahan = nir.kd_kelurahan
  and bumi.kd_znt = nir.kd_znt

  and nir.thn_nir_znt >= kelas_tanah.thn_awal_kls_tanah
  and nir.thn_nir_znt <= kelas_tanah.thn_akhir_kls_tanah
  and nir.nir >= kelas_tanah.nilai_min_tanah
  and nir.nir <= kelas_tanah.nilai_max_tanah
  and kelas_tanah.kd_kls_tanah not in ('XXX','00')

  and op.kd_propinsi = kec.kd_propinsi
  and op.kd_dati2 = kec.kd_dati2
  and op.kd_kecamatan = kec.kd_kecamatan
  and bumi.kd_propinsi = kec.kd_propinsi
  and bumi.kd_dati2 = kec.kd_dati2
  and bumi.kd_kecamatan = kec.kd_kecamatan
  and nir.kd_propinsi = kec.kd_propinsi
  and nir.kd_dati2 = kec.kd_dati2
  and nir.kd_kecamatan = kec.kd_kecamatan

  and op.kd_propinsi = kel.kd_propinsi
  and op.kd_dati2 = kel.kd_dati2
  and op.kd_kecamatan = kel.kd_kecamatan
  and op.kd_kelurahan = kel.kd_kelurahan
  and bumi.kd_propinsi = kel.kd_propinsi
  and bumi.kd_dati2 = kel.kd_dati2
  and bumi.kd_kecamatan = kel.kd_kecamatan
  and bumi.kd_kelurahan = kel.kd_kelurahan
  and nir.kd_propinsi = kel.kd_propinsi
  and nir.kd_dati2 = kel.kd_dati2
  and nir.kd_kecamatan = kel.kd_kecamatan
  and nir.kd_kelurahan = kel.kd_kelurahan
  and kec.kd_propinsi = kel.kd_propinsi
  and kec.kd_dati2 = kel.kd_dati2
  and kec.kd_kecamatan = kel.kd_kecamatan
order by op.kd_kecamatan, op.kd_kelurahan, op.kd_blok, bumi.kd_znt]]>
         </code>
      </snippet>
      <snippet name="#JUST ALFA NIR" description="">
         <code>
            <![CDATA[select * from dat_nir where THN_NIR_ZNT=2018 and KD_KECAMATAN=061 and KD_KELURAHAN=008 AND 
regexp_like(kd_znt, '[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]')



SELECT * FROM DAT_ZNT WHERE KD_KECAMATAN=040 AND KD_KELURAHAN=015;

select * from DAT_PETA_ZNT WHERE KD_KECAMATAN=040 AND KD_KELURAHAN=015 AND KD_BLOK='016'


SELECT * FROM DAT_NIR WHERE THN_NIR_ZNT='2018' AND KD_KECAMATAN='040' AND KD_KELURAHAN='015' AND    regexp_like(kd_znt, '[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]') 
ORDER BY KD_ZNT ASC;

INSERT INTO DAT_ZNT VALUES ('33','20','061','008','CQ');
INSERT INTO DAT_PETA_ZNT VALUES ('33','20','040','015','016','CP');
INSERT INTO DAT_NIR VALUES ('33','20','061','008','CQ','2018','01','01','1','20087001109','285');

]]>
         </code>
      </snippet>
      <snippet name="#OBEK NIR -KELAS TANAH" description="">
         <code>
            <![CDATA[SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP, 
B.NM_WP AS NAMA,B.SUBJEK_PAJAK_ID, 
S.JALAN_OP||' RT.'||S.RT_OP||' RW.'||S.RW_OP "ALAMAT OP",L.NM_KELURAHAN AS DESA,K.NM_KECAMATAN AS KECAMATAN,
S.TOTAL_LUAS_BNG AS BNG,D.JNS_BUMI,D.KD_ZNT,N.NIR*1000 AS NIR, S.TOTAL_LUAS_BUMI AS BUMI, 
S.TOTAL_LUAS_BUMI*(1000*H.NILAI_PER_M2_TANAH) "NJOP BUMI",T.NJOP_BUMI_SPPT,H.KD_KLS_TANAH,H.NILAI_PER_M2_TANAH*1000,S.TOTAL_LUAS_BNG*(1000*N.NILAI_PER_M2_BNG)"NJOP BANGUNAN" ,T.THN_PAJAK_SPPT AS TAHUN,NVL(T.PBB_YG_HARUS_DIBAYAR_SPPT,'0') AS PBB,  
case T.STATUS_PEMBAYARAN_SPPT when '1' then 'LUNAS' WHEN '0' THEN 'BELUM LUNAS' END AS STATUSBAYAR,S.TGL_PENDATAAN_OP,S.TGL_PEREKAMAN_OP,S.NIP_PEREKAM_OP 
FROM DAT_OBJEK_PAJAK S  
LEFT JOIN DAT_SUBJEK_PAJAK B ON ( 
S.SUBJEK_PAJAK_ID=B.SUBJEK_PAJAK_ID  
) 
LEFT JOIN SPPT_SIMULASI T ON ( 
S.KD_PROPINSI=T.KD_PROPINSI AND 
S.KD_DATI2=T.KD_DATI2 AND 
S.KD_KECAMATAN=T.KD_KECAMATAN AND 
S.KD_KELURAHAN=T.KD_KELURAHAN AND 
S.KD_BLOK=T.KD_BLOK AND 
S.NO_URUT=T.NO_URUT AND 
S.KD_JNS_OP=T.KD_JNS_OP AND 
T.THN_PAJAK_SPPT=2016 
) 
LEFT JOIN KELAS_TANAH H ON (  
T.KD_KLS_TANAH=H.KD_KLS_TANAH 
) 
LEFT JOIN KELAS_BANGUNAN N ON (  
T.KD_KLS_BNG=N.KD_KLS_BNG  
) 
LEFT JOIN DAT_OP_BUMI D ON (  
S.KD_PROPINSI=D.KD_PROPINSI AND 
S.KD_DATI2=D.KD_DATI2 AND 
S.KD_KECAMATAN=D.KD_KECAMATAN AND 
S.KD_KELURAHAN=D.KD_KELURAHAN AND 
S.KD_BLOK=D.KD_BLOK AND 
S.NO_URUT=D.NO_URUT AND 
S.KD_JNS_OP=D.KD_JNS_OP  
) 
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
LEFT JOIN DAT_NIR N ON ( 
D.KD_PROPINSI=N.KD_PROPINSI AND 
D.KD_DATI2=N.KD_DATI2 AND 
D.KD_KECAMATAN=N.KD_KECAMATAN AND 
D.KD_KELURAHAN=N.KD_KELURAHAN AND 
D.KD_ZNT=N.KD_ZNT AND 
N.THN_NIR_ZNT=2016 
)  
 
where S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN||S.KD_KELURAHAN IN ( 
3320041015
 
) 
 
 
ORDER BY S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'-'||S.KD_JNS_OP ASC]]>
         </code>
      </snippet>
      <snippet name="#DATA PENERIMAAN BY DESA BY TGL" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN,L.NM_KELURAHAN "DESA/KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN AS KODE,S.THN_PAJAK_SPPT AS TAHUN,
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) "POKOK",count(*) AS SPPT,
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT<=to_date('04052015','ddmmyyyy')) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) AS REALISASI,
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT<=to_date('04052015','ddmmyyyy')) THEN 1 ELSE 0 END) "LUNAS SPPT"

--COUNT(DECODE(S.STATUS_PEMBAYARAN_SPPT,1,1))"SPPT-LUNAS",
--COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "SPPT-BELUM",
--SUM(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "TAGIHAN",
--(SUM(B.JML_SPPT_YG_DIBAYAR)-SUM(B.DENDA_SPPT)) "REASLISASI POKOK",SUM(B.DENDA_SPPT) AS DENDA,
--SUM(B.JML_SPPT_YG_DIBAYAR) "REALISASI TOTAL"

FROM SPPT S 
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
where s.THN_PAJAK_SPPT=2015 and S.STATUS_PEMBAYARAN_SPPT in (0,1) and S.KD_KECAMATAN=100
GROUP BY  K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN,S.THN_PAJAK_SPPT ORDER BY KODE,S.THN_PAJAK_SPPT ASC
]]>
         </code>
      </snippet>
      <snippet name="#ZNT PER BLOK" description="">
         <code>
            <![CDATA[SELECT * FROM DAT_PETA_ZNT where KD_KECAMATAN=081 and KD_KELURAHAN=010]]>
         </code>
      </snippet>
      <snippet name="#DATA PENERIMAAN KEC JST" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN "KECAMATAN",'3320-'||K.KD_KECAMATAN "KODE",
SUM(PBB_YG_HARUS_DIBAYAR_SPPT) "POKOK",count(*) AS SPPT,S.THN_PAJAK_SPPT as TAHUN,
COUNT(DECODE (STATUS_PEMBAYARAN_SPPT, 0,1)) "SPPT-BELUM",
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "TAGIHAN",
COUNT(DECODE(STATUS_PEMBAYARAN_SPPT,1,1))"SPPT-LUNAS",
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI"
FROM SPPT S
LEFT JOIN REF_KECAMATAN K ON
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN
LEFT JOIN REF_KELURAHAN L ON
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN
WHERE  THN_PAJAK_SPPT=2015 AND S.STATUS_PEMBAYARAN_SPPT in(0,1) 
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,s.THN_PAJAK_SPPT order by kode asc]]>
         </code>
      </snippet>
      <snippet name="#DAFTAR NIR" description="">
         <code>
            <![CDATA[select K.NM_KECAMATAN "KECAMATAN",L.NM_KELURAHAN "KELURAHAAN", '3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN AS KODE,S.KD_ZNT "KD ZNT",S.THN_NIR_ZNT "TAHUN ZNT", S.NO_DOKUMEN AS DOKUMEN,S.NIR AS NIR    from dat_nir S
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
where THN_NIR_ZNT=2015 and regexp_like(kd_znt, '[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]')
ORDER BY NIR ASC]]>
         </code>
      </snippet>
      <snippet name="#INSERT DAT PETA ZNT" description="">
         <code>
            <![CDATA[SELECT * FROM DAT_PETA_ZNT WHERE KD_KECAMATAN=090 AND KD_KELURAHAN=011;
SELECT * FROM DAT_ZNT WHERE KD_KECAMATAN=090 AND KD_KELURAHAN=011;


SELECT * FROM DAT_NIR WHERE THN_NIR_ZNT='2018' AND KD_KECAMATAN='090' AND KD_KELURAHAN='011' AND    regexp_like(kd_znt, '[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]') 
ORDER BY KD_ZNT ASC;

INSERT INTO DAT_ZNT VALUES ('33','20','090','011','BW');
INSERT INTO DAT_PETA_ZNT VALUES ('33','20','090','011','021','BW');
INSERT INTO DAT_NIR VALUES ('33','20','090','011','BW','2018','01','01','1','20087001109','128');

]]>
         </code>
      </snippet>
      <snippet name="#TANGGAL LUNAS" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN,L.NM_KELURAHAN "DESA/KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN AS KODE,
max(B.tgl_pembayaran_sppt)

FROM SPPT S 
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
where s.THN_PAJAK_SPPT=2015 and S.STATUS_PEMBAYARAN_SPPT in (0,1) AND '3320'||K.KD_KECAMATAN||L.KD_KELURAHAN IN (
3320010001,
3320010002,
3320010003,
3320010004,
3320010005,
3320010006,
3320010007,
3320010008,
3320010009,
3320010010,
3320010011,
3320010012,
3320010013,
3320010014,
3320010015,
3320010016,
3320010017,
3320010018,
3320020004,
3320020008,
3320020009,
3320020010,
3320020011,
3320020012,
3320021001,
3320021002,
3320021005,
3320021006,
3320021008,
3320021010,
3320021011,
3320021012,
3320030001,
3320030002,
3320030003,
3320030004,
3320030005,
3320030006,
3320030007,
3320030008,
3320030009,
3320030010,
3320030011,
3320030012,
3320030013,
3320030014,
3320030015,
3320040002,
3320040003,
3320040005,
3320040006,
3320040007,
3320040008,
3320040010,
3320040012,
3320040013,
3320040014,
3320040015,
3320040017,
3320040018,
3320041001,
3320041002,
3320041003,
3320041004,
3320041005,
3320041006,
3320041007,
3320041008,
3320041009,
3320041010,
3320041011,
3320041012,
3320041013,
3320041014,
3320041015,
3320050003,
3320050004,
3320050007,
3320050008,
3320050009,
3320050010,
3320050011,
3320060012,
3320061009,
3320061010,
3320061011,
3320061012,
3320061013,
3320061014,
3320061015,
3320070006,
3320070007,
3320070008,
3320071001,
3320071002,
3320071003,
3320071004,
3320071005,
3320071006,
3320071007,
3320071008,
3320080001,
3320080002,
3320080003,
3320080005,
3320080006,
3320080008,
3320080009,
3320080010,
3320080011,
3320080012,
3320081001,
3320081002,
3320081003,
3320081004,
3320081005,
3320081006,
3320081007,
3320081008,
3320081009,
3320081010,
3320081011,
3320090001,
3320090002,
3320090003,
3320090004,
3320090005,
3320090006,
3320090007,
3320090008,
3320090009,
3320090010,
3320090011,
3320090019,
3320091001,
3320091002,
3320091003,
3320091004,
3320091005,
3320091006,
3320091007,
3320091008,
3320100004
) 
GROUP BY  K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN ORDER BY KODE DESC 
]]>
         </code>
      </snippet>
      <snippet name="#HARAG RESOURCE" description="">
         <code>
            <![CDATA[SELECT r.*,R.HRG_RESOURCE*1000 "X1000", G.NM_GROUP_RESOURCE,I.NM_RESOURCE FROM HRG_RESOURCE R
LEFT JOIN GROUP_RESOURCE G ON 
( R.KD_GROUP_RESOURCE=G.KD_GROUP_RESOURCE )
LEFT JOIN ITEM_RESOURCE I ON
(
R.KD_GROUP_RESOURCE=I.KD_GROUP_RESOURCE AND
R.KD_RESOURCE=I.KD_RESOURCE
)

WHERE R.THN_HRG_RESOURCE=2016 ORDER BY R.KD_GROUP_RESOURCE,R.KD_RESOURCE ASC]]>
         </code>
      </snippet>
      <snippet name="#PERBANDINGANtAHUN-PENETAPAN" description="">
         <code>
            <![CDATA[SELECT DISTINCT K.NM_KECAMATAN,L.NM_KELURAHAN "DESA/KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN AS KODE,
SUM(CASE WHEN ((S.THN_PAJAK_SPPT=2014 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) AS PT2014, 
SUM(CASE WHEN ((S.THN_PAJAK_SPPT=2015 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) AS PT2015, 
SUM(CASE WHEN ((S.THN_PAJAK_SPPT=2016 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) AS PT2016, 
SUM(CASE WHEN ((S.THN_PAJAK_SPPT=2014 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END) AS ST2014, 
SUM(CASE WHEN ((S.THN_PAJAK_SPPT=2015 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END) AS ST2015, 
SUM(CASE WHEN ((S.THN_PAJAK_SPPT=2016 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END) AS ST2016 
FROM SPPT S 
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )

where S.STATUS_PEMBAYARAN_SPPT in (0,1) AND S.THN_PAJAK_SPPT IN (2014,2015,2016)
GROUP BY  K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN ORDER BY KODE DESC 
]]>
         </code>
      </snippet>
      <snippet name="#PAGING CETAK MASAL" description="">
         <code>
            <![CDATA[SELECT DISTINCT K.NM_KECAMATAN,L.NM_KELURAHAN "DESA/KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN AS KODE,
--CASE WHEN ((S.THN_PAJAK_SPPT=2014 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) AS PT2014,
L.KD_SEKTOR,
ROUND((SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 5000 AND 2000000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END)/2)) AS HALAMANSPPT123, 
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 2000001 AND 5000000000000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END)) AS JUMLAHSPPT45 

FROM SPPT S 
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )

where S.STATUS_PEMBAYARAN_SPPT in (0,1) AND S.THN_PAJAK_SPPT IN (2016)
GROUP BY  K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN,L.KD_SEKTOR ORDER BY KODE DESC 
]]>
         </code>
      </snippet>
      <snippet name="#DATA REKAP BY DESA PENERIMAAN BPK" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN,L.NM_KELURAHAN "DESA/KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN AS KODE,S.THN_PAJAK_SPPT AS TAHUN,  
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) "POKOK",count(*) AS SPPT,  
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND
NOT  exists (select *  
     from pembayaran_sppt byr  
     where S.kd_propinsi = byr.kd_propinsi  
       and S.kd_dati2 = byr.kd_dati2  
       and S.kd_kecamatan = byr.kd_kecamatan  
       and S.kd_kelurahan = byr.kd_kelurahan  
       and S.kd_blok = byr.kd_blok  
       and S.no_urut = byr.no_urut  
       and S.kd_jns_op = byr.kd_jns_op  
       and S.thn_pajak_sppt = byr.thn_pajak_sppt  
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012014','DDMMYYYY') AND  to_date('31122015','DDMMYYYY')) 


) THEN 1 ELSE 0 END) "SPPT BELUM",  
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND
NOT  exists (select *  
     from pembayaran_sppt byr  
     where S.kd_propinsi = byr.kd_propinsi  
       and S.kd_dati2 = byr.kd_dati2  
       and S.kd_kecamatan = byr.kd_kecamatan  
       and S.kd_kelurahan = byr.kd_kelurahan  
       and S.kd_blok = byr.kd_blok  
       and S.no_urut = byr.no_urut  
       and S.kd_jns_op = byr.kd_jns_op  
       and S.thn_pajak_sppt = byr.thn_pajak_sppt  
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012014','DDMMYYYY') AND  to_date('31122015','DDMMYYYY'))  

) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) "TAGIHAN",   
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') ) THEN 1 ELSE 0 END) "LUNAS SPPT",  
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) "REALISASI POKOK",  
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN B.DENDA_SPPT ELSE 0 END) "REALISASI DENDA",  
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN B.JML_SPPT_YG_DIBAYAR ELSE 0 END) "REALISASI TOTAL"  
 
 
  
FROM SPPT S   
LEFT JOIN REF_KECAMATAN K ON (  
S.KD_PROPINSI=K.KD_PROPINSI AND  
S.KD_DATI2=K.KD_DATI2 AND  
S.KD_KECAMATAN=K.KD_KECAMATAN )  
LEFT JOIN REF_KELURAHAN L ON (  
S.KD_PROPINSI=L.KD_PROPINSI AND  
S.KD_DATI2=L.KD_DATI2 AND  
S.KD_KECAMATAN=L.KD_KECAMATAN AND  
S.KD_KELURAHAN=L.KD_KELURAHAN )  
LEFT JOIN pembayaran_sppt B ON (  
S.KD_PROPINSI=B.KD_PROPINSI AND  
S.KD_DATI2=B.KD_DATI2 AND  
S.KD_KECAMATAN=B.KD_KECAMATAN AND  
S.KD_KELURAHAN=B.KD_KELURAHAN AND  
S.KD_BLOK=B.KD_BLOK AND  
S.NO_URUT=B.NO_URUT AND  
S.KD_JNS_OP=B.KD_JNS_OP AND  
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT  
)  
where s.THN_PAJAK_SPPT=2014 and S.STATUS_PEMBAYARAN_SPPT in (0,1) and S.TGL_TERBIT_SPPT < to_date('01012015','ddmmyyyy')  
GROUP BY  K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN,S.THN_PAJAK_SPPT ORDER BY KODE,S.THN_PAJAK_SPPT ASC]]>
         </code>
      </snippet>
      <snippet name="#DATA PENERIMAAN PER TAHUN TERBIT" description="">
         <code>
            <![CDATA[SELECT EXTRACT(YEAR FROM S.TGL_TERBIT_SPPT) AS TAHUN,
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND
 exists (select *  
     from pembayaran_sppt byr  
     where S.kd_propinsi = byr.kd_propinsi  
       and S.kd_dati2 = byr.kd_dati2  
       and S.kd_kecamatan = byr.kd_kecamatan  
       and S.kd_kelurahan = byr.kd_kelurahan  
       and S.kd_blok = byr.kd_blok  
       and S.no_urut = byr.no_urut  
       and S.kd_jns_op = byr.kd_jns_op  
       and S.thn_pajak_sppt = byr.thn_pajak_sppt  
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012015','DDMMYYYY') AND  to_date('31122015','DDMMYYYY')) 
) THEN 1 ELSE 0 END) "SPPT BAYAR",
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND
 exists (select *  
     from pembayaran_sppt byr  
     where S.kd_propinsi = byr.kd_propinsi  
       and S.kd_dati2 = byr.kd_dati2  
       and S.kd_kecamatan = byr.kd_kecamatan  
       and S.kd_kelurahan = byr.kd_kelurahan  
       and S.kd_blok = byr.kd_blok  
       and S.no_urut = byr.no_urut  
       and S.kd_jns_op = byr.kd_jns_op  
       and S.thn_pajak_sppt = byr.thn_pajak_sppt  
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012015','DDMMYYYY') AND  to_date('31122015','DDMMYYYY')) 
) THEN B.JML_SPPT_YG_DIBAYAR ELSE 0 END) "TOTAL REALISASI"
FROM SPPT S
LEFT JOIN pembayaran_sppt B ON (  
S.KD_PROPINSI=B.KD_PROPINSI AND  
S.KD_DATI2=B.KD_DATI2 AND  
S.KD_KECAMATAN=B.KD_KECAMATAN AND  
S.KD_KELURAHAN=B.KD_KELURAHAN AND  
S.KD_BLOK=B.KD_BLOK AND  
S.NO_URUT=B.NO_URUT AND  
S.KD_JNS_OP=B.KD_JNS_OP AND  
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT  
) 
WHERE S.TGL_TERBIT_SPPT BETWEEN TO_DATE('01012009','ddmmyyyy') AND TO_DATE('31122015','ddmmyyyy') 
GROUP BY EXTRACT(YEAR FROM S.TGL_TERBIT_SPPT) ORDER BY EXTRACT(YEAR FROM S.TGL_TERBIT_SPPT) ASC
]]>
         </code>
      </snippet>
      <snippet name="#HAPUS NOP RELASI SPPT TEMPORARI" description="">
         <code>
            <![CDATA[delete from PEMBAYARAN_SPPT B
where B.TGL_PEMBAYARAN_SPPT<to_date('01012014','ddmmyyyy')
and B.KD_KECAMATAN=060 
and B.KD_KELURAHAN=015
and  exists (select *  
     from SPPT_TEMP t  
     where b.kd_propinsi = t.kd_propinsi  
       and b.kd_dati2 = t.kd_dati2  
       and b.kd_kecamatan = t.kd_kecamatan  
       and b.kd_kelurahan = t.kd_kelurahan  
       and b.kd_blok = t.kd_blok  
       and b.no_urut = t.no_urut  
       and b.kd_jns_op = t.kd_jns_op  
       and b.thn_pajak_sppt = t.thn_pajak_sppt  
     )
]]>
         </code>
      </snippet>
      <snippet name="#DATA PENERIMAAN ALL TAHUN DITAHUN BERJALAN" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN,L.NM_KELURAHAN "DESA/KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN AS KODE,  
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) and S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy'))
THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) "POKOK",
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) and S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN 1 ELSE 0 END) "SPPT", 
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND S.THN_PAJAK_SPPT=2015 AND S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') AND
NOT  exists (select *  
     from pembayaran_sppt byr  
     where S.kd_propinsi = byr.kd_propinsi  
       and S.kd_dati2 = byr.kd_dati2  
       and S.kd_kecamatan = byr.kd_kecamatan  
       and S.kd_kelurahan = byr.kd_kelurahan  
       and S.kd_blok = byr.kd_blok  
       and S.no_urut = byr.no_urut  
       and S.kd_jns_op = byr.kd_jns_op  
       and S.thn_pajak_sppt = byr.thn_pajak_sppt  
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012015','DDMMYYYY') AND  to_date('31122015','DDMMYYYY')) 
) THEN 1 ELSE 0 END) "SPPT BELUM",  
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND S.THN_PAJAK_SPPT=2015 AND S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') AND 
NOT  exists (select *  
     from pembayaran_sppt byr  
     where S.kd_propinsi = byr.kd_propinsi  
       and S.kd_dati2 = byr.kd_dati2  
       and S.kd_kecamatan = byr.kd_kecamatan  
       and S.kd_kelurahan = byr.kd_kelurahan  
       and S.kd_blok = byr.kd_blok  
       and S.no_urut = byr.no_urut  
       and S.kd_jns_op = byr.kd_jns_op  
       and S.thn_pajak_sppt = byr.thn_pajak_sppt  
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012015','DDMMYYYY') AND  to_date('31122015','DDMMYYYY'))  

) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) "TAGIHAN",  
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') ) THEN 1 ELSE 0 END) "LUNAS SPPT",   
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) "REALISASI POKOK",   
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN B.DENDA_SPPT ELSE 0 END) "REALISASI DENDA",   
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN B.JML_SPPT_YG_DIBAYAR ELSE 0 END) "REALISASI TOTAL"   
   
   
FROM SPPT S    
LEFT JOIN REF_KECAMATAN K ON (   
S.KD_PROPINSI=K.KD_PROPINSI AND   
S.KD_DATI2=K.KD_DATI2 AND   
S.KD_KECAMATAN=K.KD_KECAMATAN )   
LEFT JOIN REF_KELURAHAN L ON (   
S.KD_PROPINSI=L.KD_PROPINSI AND   
S.KD_DATI2=L.KD_DATI2 AND   
S.KD_KECAMATAN=L.KD_KECAMATAN AND   
S.KD_KELURAHAN=L.KD_KELURAHAN )   
LEFT JOIN pembayaran_sppt B ON (   
S.KD_PROPINSI=B.KD_PROPINSI AND   
S.KD_DATI2=B.KD_DATI2 AND   
S.KD_KECAMATAN=B.KD_KECAMATAN AND   
S.KD_KELURAHAN=B.KD_KELURAHAN AND   
S.KD_BLOK=B.KD_BLOK AND   
S.NO_URUT=B.NO_URUT AND   
S.KD_JNS_OP=B.KD_JNS_OP AND   
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT   
)   
where s.THN_PAJAK_SPPT BETWEEN 2009 and 2015 and S.STATUS_PEMBAYARAN_SPPT in (0,1)   
GROUP BY  K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN ORDER BY KODE ASC]]>
         </code>
      </snippet>
      <snippet name="#DATA PENERIMAAN REKAP DESA TAHUN BERJALAN + OPBARU" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN,L.NM_KELURAHAN "DESA/KELURAHAN",'3320-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN AS KODE,   
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND S.THN_PAJAK_SPPT=2015 and S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) 
THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) "POKOK", 
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND S.THN_PAJAK_SPPT=2015 and S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN 1 ELSE 0 END) "SPPT",  
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND S.THN_PAJAK_SPPT=2015 AND S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') AND 
NOT  exists (select *   
     from pembayaran_sppt byr   
     where S.kd_propinsi = byr.kd_propinsi   
       and S.kd_dati2 = byr.kd_dati2   
       and S.kd_kecamatan = byr.kd_kecamatan   
       and S.kd_kelurahan = byr.kd_kelurahan   
       and S.kd_blok = byr.kd_blok   
       and S.no_urut = byr.no_urut   
       and S.kd_jns_op = byr.kd_jns_op   
       and S.thn_pajak_sppt = byr.thn_pajak_sppt   
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012015','DDMMYYYY') AND  to_date('31122015','DDMMYYYY'))  
) THEN 1 ELSE 0 END) "SPPT BELUM",   
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT IN (0,1)) AND S.THN_PAJAK_SPPT=2015 AND S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') AND  
NOT  exists (select *   
     from pembayaran_sppt byr   
     where S.kd_propinsi = byr.kd_propinsi   
       and S.kd_dati2 = byr.kd_dati2   
       and S.kd_kecamatan = byr.kd_kecamatan   
       and S.kd_kelurahan = byr.kd_kelurahan   
       and S.kd_blok = byr.kd_blok   
       and S.no_urut = byr.no_urut   
       and S.kd_jns_op = byr.kd_jns_op   
       and S.thn_pajak_sppt = byr.thn_pajak_sppt   
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012015','DDMMYYYY') AND  to_date('31122015','DDMMYYYY'))   
 
) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) "TAGIHAN",   
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) AND S.THN_PAJAK_SPPT=2015 and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') ) THEN 1 ELSE 0 END) "LUNAS SPPT",    
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) AND S.THN_PAJAK_SPPT=2015 and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) "REALISASI POKOK",    
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) AND S.THN_PAJAK_SPPT=2015 and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN B.DENDA_SPPT ELSE 0 END) "REALISASI DENDA",    
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) AND S.THN_PAJAK_SPPT=2015 and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN B.JML_SPPT_YG_DIBAYAR ELSE 0 END) "REALISASI TOTAL",    
    
----OPBARU
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) AND S.THN_PAJAK_SPPT BETWEEN 2009 AND 2014 AND  S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')
and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN 1 ELSE 0 END) "LUNAS SPPT OP BARU",    
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) AND S.THN_PAJAK_SPPT BETWEEN 2009 AND 2014 AND S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') 
and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT ELSE 0 END) "REALISASI POKOK OP BARU",    
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) AND S.THN_PAJAK_SPPT BETWEEN 2009 AND 2014 AND  S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') 
AND B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN B.DENDA_SPPT ELSE 0 END) "REALISASI DENDA OP BARU",    
SUM(CASE WHEN ((S.STATUS_PEMBAYARAN_SPPT=1) AND S.THN_PAJAK_SPPT BETWEEN 2009 AND 2014 AND  S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy') 
and B.TGL_PEMBAYARAN_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')) THEN B.JML_SPPT_YG_DIBAYAR ELSE 0 END) "REALISASI TOTAL OP BARU"    
    

FROM SPPT S     
LEFT JOIN REF_KECAMATAN K ON (    
S.KD_PROPINSI=K.KD_PROPINSI AND    
S.KD_DATI2=K.KD_DATI2 AND    
S.KD_KECAMATAN=K.KD_KECAMATAN )    
LEFT JOIN REF_KELURAHAN L ON (    
S.KD_PROPINSI=L.KD_PROPINSI AND    
S.KD_DATI2=L.KD_DATI2 AND    
S.KD_KECAMATAN=L.KD_KECAMATAN AND    
S.KD_KELURAHAN=L.KD_KELURAHAN )    
LEFT JOIN pembayaran_sppt B ON (    
S.KD_PROPINSI=B.KD_PROPINSI AND    
S.KD_DATI2=B.KD_DATI2 AND    
S.KD_KECAMATAN=B.KD_KECAMATAN AND    
S.KD_KELURAHAN=B.KD_KELURAHAN AND    
S.KD_BLOK=B.KD_BLOK AND    
S.NO_URUT=B.NO_URUT AND    
S.KD_JNS_OP=B.KD_JNS_OP AND    
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT    
)    
where s.THN_PAJAK_SPPT BETWEEN 2009 and 2015 and S.STATUS_PEMBAYARAN_SPPT in (0,1)  and S.TGL_TERBIT_SPPT between  to_date('01012015','ddmmyyyy') and to_date('31122015','ddmmyyyy')   
GROUP BY  K.NM_KECAMATAN,L.NM_KELURAHAN,K.KD_KECAMATAN,L.KD_KELURAHAN ORDER BY KODE ASC]]>
         </code>
      </snippet>
      <snippet name="#KAT PIUTANG BY NOP" description="">
         <code>
            <![CDATA[select  s.KD_PROPINSI||s.KD_DATI2||s.KD_KECAMATAN||s.KD_KELURAHAN||s.KD_BLOK||s.NO_URUT||s.KD_JNS_OP as NOP, 
s.NM_WP_SPPT "NAMA WAJIB PAJAK",s.PBB_YG_HARUS_DIBAYAR_SPPT "TAGIHAN POKOK PBB",
CASE WHEN (
(select count (*) 
from sppt b where 
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP 
and b.THN_PAJAK_SPPT between 2009 and 2014
and b.STATUS_PEMBAYARAN_SPPT=0
)=1) THEN 'LANCAR'
WHEN (
(select count (*) 
from sppt b where 
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP 
and b.THN_PAJAK_SPPT between 2009 and 2014
and b.STATUS_PEMBAYARAN_SPPT=0
)=2) THEN 'KURANG LANCAR'
WHEN (
(select count (*) 
from sppt b where 
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP 
and b.THN_PAJAK_SPPT between 2009 and 2014
and b.STATUS_PEMBAYARAN_SPPT=0
) IN (3,4,5)) THEN 'DIRAGUKAN'
ELSE 'MACET TOTAL' END "KATEGORI PIUTANG" 


from sppt s
where 
s.THN_PAJAK_SPPT=2014 and s.STATUS_PEMBAYARAN_SPPT=0 ]]>
         </code>
      </snippet>
      <snippet name="#DAF NILAI INDIVIDU" description="">
         <code>
            <![CDATA[SELECT KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP AS NOP,NILAI_INDIVIDU  
FROM DAT_NILAI_INDIVIDU
ORDER BY KD_PROPINSI,KD_DATI2,KD_KECAMATAN,KD_KELURAHAN,KD_BLOK,NO_URUT,KD_JNS_OP
]]>
         </code>
      </snippet>
      <snippet name="#UP LUNAS DESA" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN "KELURAHAN/DESA",LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE, 
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK, 
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG", 
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI", 
count(*) as JMLSPPT, 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "BELUMLUNAS", 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) "LUNAS", 
TRUNC((COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) / count(*))*100,2) AS PERSENTASE, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1 AND 1999 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 1 ELSE 0 END) AS R1, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000 AND 100000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 1 ELSE 0 END) AS R2, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 100001 AND 500000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 1 ELSE 0 END) AS R3, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 500001 AND 1000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 1 ELSE 0 END) AS R4, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1000001 AND 2000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 1 ELSE 0 END) AS R5, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000001 AND 5000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 1 ELSE 0 END) AS R6, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000001 AND 10000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 1 ELSE 0 END) AS R7, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 10000001 AND 25000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 1 ELSE 0 END) AS R8, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 25000001  AND 60000000) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1)))   THEN 1 ELSE 0 END) AS R9, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 60000001  AND 300000000) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1)))   THEN 1 ELSE 0 END) AS R10, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) > 300000000) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1)))   THEN 1 ELSE 0 END) AS R11, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1 AND 1999 ) AND  (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 500 ELSE 0 END) AS H1, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000 AND 100000  ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 1500 ELSE 0 END) AS H2, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 100001 AND 500000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 8000 ELSE 0 END) AS H3, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 500001 AND 1000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 25000 ELSE 0 END) AS H4, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1000001 AND 2000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 50000 ELSE 0 END) AS H5, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000001 AND 5000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 350000 ELSE 0 END) AS H6, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000001 AND 10000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 550000 ELSE 0 END) AS H7, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 10000001 AND 25000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 800000 ELSE 0 END) AS H8, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 25000001  AND 60000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 2000000 ELSE 0 END) AS H9,
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 60000001  AND 300000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 3000000 ELSE 0 END) AS H10, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) > 300000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (0,1))) THEN 4000000 ELSE 0 END) AS H11 
FROM SPPT S  
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN pembayaran_sppt B ON ( 
S.KD_PROPINSI=B.KD_PROPINSI AND 
S.KD_DATI2=B.KD_DATI2 AND 
S.KD_KECAMATAN=B.KD_KECAMATAN AND 
S.KD_KELURAHAN=B.KD_KELURAHAN AND 
S.KD_BLOK=B.KD_BLOK AND 
S.NO_URUT=B.NO_URUT AND 
S.KD_JNS_OP=B.KD_JNS_OP AND 
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT 
) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
WHERE  S.THN_PAJAK_SPPT=TO_CHAR(sysdate,'YYYY') AND S.STATUS_PEMBAYARAN_SPPT IN(0,1) and 
S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN  IN (
3320070
)


GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY persentase desc]]>
         </code>
      </snippet>
      <snippet name="#UPDATE KTP" description="">
         <code>
            <![CDATA[select * from DAT_SUBJEK_PAJAK where SUBJEK_PAJAK_ID='3320020603630001';
update DAT_SUBJEK_PAJAK set NM_WP='FARKHAN',JALAN_WP='PECANGAAN KULON',RT_WP='001',RW_WP='05'  where SUBJEK_PAJAK_ID='3320020603630001';]]>
         </code>
      </snippet>
      <snippet name="#UP SIMULASI" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN "KELURAHAN/DESA",LPAD(K.KD_KECAMATAN||L.KD_KELURAHAN,'10','3320') AS KODE, 
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK, 
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG", 
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI", 
count(*) as JMLSPPT, 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "BELUMLUNAS", 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) "LUNAS", 
TRUNC((COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) / count(*))*100,2) AS PERSENTASE, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1 AND 1999 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 1 ELSE 0 END) AS R1, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000 AND 100000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 1 ELSE 0 END) AS R2, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 100001 AND 500000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 1 ELSE 0 END) AS R3, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 500001 AND 1000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 1 ELSE 0 END) AS R4, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1000001 AND 2000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 1 ELSE 0 END) AS R5, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000001 AND 5000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 1 ELSE 0 END) AS R6, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000001 AND 10000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 1 ELSE 0 END) AS R7, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 10000001 AND 25000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 1 ELSE 0 END) AS R8, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 25000001  AND 60000000) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0)))   THEN 1 ELSE 0 END) AS R9, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 60000001  AND 300000000) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0)))   THEN 1 ELSE 0 END) AS R10, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) > 300000000) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0)))   THEN 1 ELSE 0 END) AS R11, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1 AND 1999 ) AND  (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 500 ELSE 0 END) AS H1, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000 AND 100000  ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 1500 ELSE 0 END) AS H2, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 100001 AND 500000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 8000 ELSE 0 END) AS H3, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 500001 AND 1000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 25000 ELSE 0 END) AS H4, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1000001 AND 2000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 50000 ELSE 0 END) AS H5, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000001 AND 5000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 350000 ELSE 0 END) AS H6, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000001 AND 10000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 550000 ELSE 0 END) AS H7, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 10000001 AND 25000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 800000 ELSE 0 END) AS H8, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 25000001  AND 60000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 2000000 ELSE 0 END) AS H9,
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 60000001  AND 300000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 3000000 ELSE 0 END) AS H10, 
SUM(CASE WHEN (((S.PBB_YG_HARUS_DIBAYAR_SPPT) > 300000000 ) AND (S.STATUS_PEMBAYARAN_SPPT in (1,0))) THEN 4000000 ELSE 0 END) AS H11 
FROM SPPT S  
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN pembayaran_sppt B ON ( 
S.KD_PROPINSI=B.KD_PROPINSI AND 
S.KD_DATI2=B.KD_DATI2 AND 
S.KD_KECAMATAN=B.KD_KECAMATAN AND 
S.KD_KELURAHAN=B.KD_KELURAHAN AND 
S.KD_BLOK=B.KD_BLOK AND 
S.NO_URUT=B.NO_URUT AND 
S.KD_JNS_OP=B.KD_JNS_OP AND 
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT 
) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
WHERE  S.THN_PAJAK_SPPT=TO_CHAR(sysdate,'YYYY') AND S.STATUS_PEMBAYARAN_SPPT IN(0,1) and 
S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN||S.KD_KELURAHAN   IN (
3320050010

)


GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY persentase desc]]>
         </code>
      </snippet>
      <snippet name="#GBG QUERY" description="">
         <code>
            <![CDATA[SELECT  * FROM DAT_OP_BUMI WHERE KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP in (
332004001501600410,
332004001501600440,
332004001501600520,
332004001501600530,
332004001501600540,
332004001501600560,
332004001501600570,
332004001501600580,
332004001501600590,
332004001501600600,
332004001501600610,
332004001501600620,
332004001501600630,
332004001501600640,
332004001501600650,
332004001501600660,
332004001501600670,
332004001501600680,
332004001501600690,
332004001501600700,
332004001501600710,
332004001501600720,
332004001501600730,
332004001501600770,
332004001501600780,
332004001501600790,
332004001501600800,
332004001501600810,
332004001501601230,
332004001501601380,
332004001501601390,
332004001501601400,
332004001501601410,
332004001501601430,
332004001501601440,
332004001501601570,
332004001501601580,
332004001501601610,
332004001501601620
); 

update DAT_OP_BUMI set JNS_BUMI='5' where KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP in (
332004001501600410,
332004001501600440,
332004001501600520,
332004001501600530,
332004001501600540,
332004001501600560,
332004001501600570,
332004001501600580,
332004001501600590,
332004001501600600,
332004001501600610,
332004001501600620,
332004001501600630,
332004001501600640,
332004001501600650,
332004001501600660,
332004001501600670,
332004001501600680,
332004001501600690,
332004001501600700,
332004001501600710,
332004001501600720,
332004001501600730,
332004001501600770,
332004001501600780,
332004001501600790,
332004001501600800,
332004001501600810,
332004001501601230,
332004001501601380,
332004001501601390,
332004001501601400,
332004001501601410,
332004001501601430,
332004001501601440,
332004001501601570,
332004001501601580,
332004001501601610,
332004001501601620
); 
]]>
         </code>
      </snippet>
      <snippet name="#REKAP-PENETAPAN-TIAP-TAHUN" description="">
         <code>
            <![CDATA[SELECT THN_PAJAK_SPPT,SUM(PBB_TERHUTANG_SPPT) "POKOK TERHUTANG",
SUM(PBB_YG_HARUS_DIBAYAR_SPPT) "POKOK YG DIABAYAR",
count(*) AS "TOTALSPPT",
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI", 
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG", 
COUNT(DECODE (STATUS_PEMBAYARAN_SPPT, 0,1)) "SPPT BELUM LUNAS"
FROM SPPT WHERE STATUS_PEMBAYARAN_SPPT IN ('0','1') AND 
THN_PAJAK_SPPT BETWEEN 2014 AND 2018
GROUP BY THN_PAJAK_SPPT
ORDER BY THN_PAJAK_SPPT ASC]]>
         </code>
      </snippet>
      <snippet name="#DBUNDIAN" description="">
         <code>
            <![CDATA[
SELECT S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN||S.KD_KELURAHAN||S.KD_BLOK||S.NO_URUT||S.KD_JNS_OP as kode,
S.NM_WP_SPPT AS nama,replace(K.NM_KECAMATAN,' ','') AS kecamatan,
L.NM_KELURAHAN "desa"
FROM SPPT S 

LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where
  exists (select *            
     from pembayaran_sppt byr            
     where S.kd_propinsi = byr.kd_propinsi            
       and S.kd_dati2 = byr.kd_dati2            
       and S.kd_kecamatan = byr.kd_kecamatan            
       and S.kd_kelurahan = byr.kd_kelurahan            
       and S.kd_blok = byr.kd_blok            
       and S.no_urut = byr.no_urut            
       and S.kd_jns_op = byr.kd_jns_op            
       and S.thn_pajak_sppt = byr.thn_pajak_sppt   
       and S.THN_PAJAK_SPPT='2019'
       and byr.tgl_pembayaran_sppt BETWEEN to_date('01012019','DDMMYYYY') AND  to_date('15082019','DDMMYYYY')         
) 
and s.THN_PAJAK_SPPT=TO_CHAR(sysdate,'YYYY') and S.STATUS_PEMBAYARAN_SPPT in (0,1)  and
(
S.NM_WP_SPPT NOT  LIKE ( '%TELKOM%') AND 
S.NM_WP_SPPT NOT  LIKE ( '%TELKOMSEL%') AND 
S.NM_WP_SPPT NOT  LIKE ('%INDOSAT%') AND 
S.NM_WP_SPPT NOT  LIKE ('%PROTELINDO%') AND 
S.NM_WP_SPPT  NOT LIKE ('%XL AXIATA%') AND 
S.NM_WP_SPPT NOT  LIKE ('%NATRINDO%')AND 
S.NM_WP_SPPT NOT  LIKE ('%JAVA POWER%') AND
S.NM_WP_SPPT NOT  LIKE ('%TOWER BERSAMA%') AND
S.NM_WP_SPPT NOT  LIKE ('%PT. KERETA API INDONESIA%') 

)
ORDER BY K.NM_KECAMATAN,S.KD_KELURAHAN ASC;
]]>
         </code>
      </snippet>
      <snippet name="#SURAT-TAGIHAN" description="">
         <code>
            <![CDATA[SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP, 

S.NM_WP_SPPT AS NAMA_WP,S.LUAS_BUMI_SPPT AS BUMI,S.LUAS_BNG_SPPT AS BANGUNAN ,S.THN_PAJAK_SPPT "TAHUN", K.NM_KECAMATAN AS KECAMATAN, 
L.NM_KELURAHAN "DESA", S.JLN_WP_SPPT||' RT.'||S.RT_WP_SPPT||' RW.'||S.RW_WP_SPPT  AS ALAMATWP,T.JALAN_OP||' RT.'||T.RT_OP||' RW.'||T.RW_OP "ALAMATOP", S.PBB_YG_HARUS_DIBAYAR_SPPT AS T2018,
S.KELURAHAN_WP_SPPT,S.KOTA_WP_SPPT,
(SELECT A.PBB_YG_HARUS_DIBAYAR_SPPT FROM SPPT A WHERE
S.KD_PROPINSI=A.KD_PROPINSI AND 
S.KD_DATI2=A.KD_DATI2 AND 
S.KD_KECAMATAN=A.KD_KECAMATAN AND 
S.KD_KELURAHAN=A.KD_KELURAHAN AND 
S.KD_BLOK=A.KD_BLOK AND 
S.NO_URUT=A.NO_URUT AND 
S.KD_JNS_OP=A.KD_JNS_OP AND 
A.THN_PAJAK_SPPT='2017' AND A.STATUS_PEMBAYARAN_SPPT='0') T2017,
(SELECT A.PBB_YG_HARUS_DIBAYAR_SPPT FROM SPPT A WHERE
S.KD_PROPINSI=A.KD_PROPINSI AND 
S.KD_DATI2=A.KD_DATI2 AND 
S.KD_KECAMATAN=A.KD_KECAMATAN AND 
S.KD_KELURAHAN=A.KD_KELURAHAN AND 
S.KD_BLOK=A.KD_BLOK AND 
S.NO_URUT=A.NO_URUT AND 
S.KD_JNS_OP=A.KD_JNS_OP AND 
A.THN_PAJAK_SPPT='2016' AND A.STATUS_PEMBAYARAN_SPPT='0') T2016,
(SELECT A.PBB_YG_HARUS_DIBAYAR_SPPT FROM SPPT A WHERE
S.KD_PROPINSI=A.KD_PROPINSI AND 
S.KD_DATI2=A.KD_DATI2 AND 
S.KD_KECAMATAN=A.KD_KECAMATAN AND 
S.KD_KELURAHAN=A.KD_KELURAHAN AND 
S.KD_BLOK=A.KD_BLOK AND 
S.NO_URUT=A.NO_URUT AND 
S.KD_JNS_OP=A.KD_JNS_OP AND 
A.THN_PAJAK_SPPT='2015' AND A.STATUS_PEMBAYARAN_SPPT='0') T2015,
(SELECT A.PBB_YG_HARUS_DIBAYAR_SPPT FROM SPPT A WHERE
S.KD_PROPINSI=A.KD_PROPINSI AND 
S.KD_DATI2=A.KD_DATI2 AND 
S.KD_KECAMATAN=A.KD_KECAMATAN AND 
S.KD_KELURAHAN=A.KD_KELURAHAN AND 
S.KD_BLOK=A.KD_BLOK AND 
S.NO_URUT=A.NO_URUT AND 
S.KD_JNS_OP=A.KD_JNS_OP AND 
A.THN_PAJAK_SPPT='2014' AND A.STATUS_PEMBAYARAN_SPPT='0') T2014



FROM SPPT S  
LEFT JOIN DAT_OBJEK_PAJAK T ON ( 
S.KD_PROPINSI=T.KD_PROPINSI AND 
S.KD_DATI2=T.KD_DATI2 AND 
S.KD_KECAMATAN=T.KD_KECAMATAN AND 
S.KD_KELURAHAN=T.KD_KELURAHAN AND 
S.KD_BLOK=T.KD_BLOK AND 
S.NO_URUT=T.NO_URUT AND 
S.KD_JNS_OP=T.KD_JNS_OP 
) 
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
where s.THN_PAJAK_SPPT='2018'  and S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN||S.KD_KELURAHAN||S.KD_BLOK||S.NO_URUT||S.KD_JNS_OP  in (
332006000900200190,
332006100402902020,
332004000902900020,
332006000700600420,
332006000100600050,
332006100100502030,
332006100500700580,
332006000500401010,
332006100301301090,
332006001001300240,
332005000200901870,
332006000202200240,
332006000600700010,
332006000700501250,
332006000900300250,
332006100101100230,
332002000202100690,
332005000600200800,
332006001001300840,
332002000202300750,
332006000600800600,
332007000300200520,
332006000600201520,
332002000501600110,
332006000100600010,
332002100900300390,
332006000700201220,
332006001300302180,
332002000302300180,
332002000602800400,
332006100400401730,
332002000100100030,
332006000700600970,
332006001100500350,
332002000600300040,
332002100402000610,
332006000202200500,
332006100100501630,
332006000100600150,
332006100201100040,
332008000502000040,
332007000401601370,
332010000103500840,
332006001001101150,
332006100400801000,
332006001001300040,
332006100304600240,
332006100100100230,
332006100100100390,
332006100100501480,
332006100101300600,
332007000702400150,
332002100900302100,
332002000301001150,
332006100500501150,
332006001100900600,
332004000902400980,
332006100400801110,
332006000201800010,
332002100700801570,
332006000201100940,
332006000101500570,
332008000602900100,
332006100100100240,
332005000201702600,
332006000900300160,
332002000602800280,
332006100500601870,
332004000901900240,
332005000102000360,
332002000300300290,
332006000900200130,
332006001400300370,
332002000202201090,
332006100100401020,
332006001000100360,
332006100100401950,
332006000200602130,
332006100403400010,
332006100403301560,
332006100403301890,
332006100101200200,
332006100201100030,
332006100201400110,
332006000500200150,
332006100101200140,
332006000101800730,
332002000300400080,
332005000202001400,
332006100403500750,
332006100100102010,
332006100400900640,
332005000200503770,
332006001100100010,
332006000300600670,
332006100403300990,
332002000600300640,
332002000202301390,
332006100401401700,
332004000901900020,
332006100401301320,
332002000302300170,
332006100401000070,
332006100101200120,
332006000201101030,
332008000602201130,
332005000200100710,
332006100304701770,
332002000602700350,
332006001001300830,
332005000903700550,
332006000900100250,
332005000201800430,
332004000902100010,
332004000902000010,
332002000100800210,
332005000200902500,
332006001600800260,
332006000900200080,
332006000202000090,
332010000103000010,
332006000700700040,
332006001001200190,
332006100500300040,
332002001101500740,
332006100201000050,
332006100101000610,
332006100403600620,
332006100101100140,
332006000900200200,
332002000500300960,
332004000902900040,
332006000900400820,
332006100402900020,
332005000201001380,
332010000101900010,
332006000900200040,
332005000101000730,
332006000500200690,
332006001001100990,
332006000700801810,
332006000600800410,
332006100100501400,
332005000201001340,
332006100201100350,
332006000900600470,
332006100100501510,
332006001001100930,
332005000201100290,
332006100403400380,
332006001100601500,
332006100100100280,
332002000300402100,
332006100400402650,
332006001001300280,
332006100400400320,
332006100400801080,
332006001600700770,
332006000900100230,
332002100401800200,
332006000700801620,
332006100100100260,
332006000900401170,
332006100100501620,
332006100401200010,
332006100100100370,
332006100400901130,
332002000601200240,
332006001000400020,
332006100100100290,
332005000200901860,
332006100403301570,
332006100500800400,
332006000600301230,
332006100400600560,
332006000900700080,
332006001100100130,
332006000900401210,
332008000604100340,
332010000103600020,
332006000700700410,
332002001100600810,
332006100500800410,
332007000501100710,
332006100101200010,
332005000200504050,
332006001001300090,
332006000900100080,
332006100400700200,
332004000100900090,
332006100500200630,
332006100100600610,
332006100201402620,
332006000600301320,
332006000600301310,
332006000600301390,
332002000202501340,
332006100100600600,
332006100100501580,
332002000100401170,
332006100500300130,
332006100101100070,
332006100101100090,
332006001300500040,
332006001000100240,
332006100201400490,
332006100500200080,
332006100304600210,
332007000403500470,
332008000701800450,
332006001001101000,
332006001100700160,
332006001300301160,
332006100101400070,
332006100100100250,
332005000101501510,
332006100100502100,
332005000200102390,
332006100101400050,
332006001300401110,
332006100500700530,
332006100100200320,
332004000901300090,
332006100201400160,
332006100403400440,
332010000102700420,
332002100300600010,
332006100500300150,
332010000103000330,
332005000201200010,
332006100100300970,
332006000600100440,
332006000202300900,
332006000900401230,
332010000104300010,
332008000701900010,
332006001001300300,
332006000600301380,
332006100101200070,
332006100402901980,
332005000600401590,
332006100101100240,
332006100500501080,
332006100100401290,
332002000602000050,
332006001001300290,
332006100702701180,
332002000300300770,
332005000200901730,
332007000700400680,
332006100100401620,
332006100500501070,
332006100100200570,
332006100403301900,
332006100100200010,
332006100101100200,
332002000201200570,
332006100403302140,
332004000901900010,
332006000900100120,
332006100100700540,
332006000900401180,
332006100403400190,
332006100101000640,
332006100500501020,
332006001300301110,
332006000900600520,
332006100400600370,
332006100101100250,
332002001100600340,
332004000400200020,
332006100100502010,
332004000902900440,
332002000601800470,
332004000902900450,
332006100500400350,
332006100500800340,
332006100403600980,
332006100400400750,
332006001400300380,
332006100101000630,
332010000104300040,
332006000600201430,
332006000900500820,
332006100201400360,
332006000800601960,
332006100403600140,
332010000102700080,
332006100100501940,
332002001100600310,
332006100400101350,
332005000201100300,
332007000400300030,
332004000901400190,
332006100500500960,
332005000201201110,
332004000900500240,
332006001000900700,
332006100403100700,
332006100500601770
)
order by S.KD_KECAMATAN,S.KD_KELURAHAN DESC]]>
         </code>
      </snippet>
      <snippet name="#BUKU 12345" description="">
         <code>
            <![CDATA[select
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 1 AND 100000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT  ELSE 0 END)) AS NOMINALBUKU1, 
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 1 AND 100000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END)) AS WPBUKU1,
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 100001 AND 500000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT  ELSE 0 END)) AS NOMINALBUKU2, 
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 100001 AND 500000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END)) AS WPBUKU2,
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 500001 AND 2000000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT  ELSE 0 END)) AS NOMINALBUKU3, 
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 500001 AND 2000000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END)) AS WPBUKU3,
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 2000001 AND 5000000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT  ELSE 0 END)) AS NOMINALBUKU4, 
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 2000001 AND 5000000 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END)) AS WPBUKU4,
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 5000001 AND 999999999999 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN S.PBB_YG_HARUS_DIBAYAR_SPPT  ELSE 0 END)) AS NOMINALBUKU5, 
(SUM(CASE WHEN ((S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 5000001 AND 999999999999 AND S.STATUS_PEMBAYARAN_SPPT IN(0,1))) THEN 1 ELSE 0 END)) AS WPBUKU5





FROM SPPT S 
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )

where S.STATUS_PEMBAYARAN_SPPT in (0,1) AND S.THN_PAJAK_SPPT=2018

]]>
         </code>
      </snippet>
      <snippet name="#NP PEREKAM" description="">
         <code>
            <![CDATA[UPDATE DAT_OBJEK_PAJAK SET NIP_PEREKAM_OP='201401012014010102' WHERE  KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP in (
332001000600500010,
332001000600800040
); ]]>
         </code>
      </snippet>
      <snippet name="#LSPOP" description="">
         <code>
            <![CDATA[select S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN||S.KD_KELURAHAN||S.KD_BLOK||S.NO_URUT||S.KD_JNS_OP AS NOP,D.NO_BNG,S.THN_DIBANGUN_BNG,
J.NM_JPB AS JENISBANGUNGAN,S.LUAS_BNG,S.JML_LANTAI_BNG,
DECODE(S.KONDISI_BNG, 1, 'SANGAT BAIK',2, 'BAIK',3, 'SEDANG','JELEK') KONDISIBGN,
DECODE(S.JNS_KONSTRUKSI_BNG, 1, 'BAJA',2, 'BETON',3, 'BATU BATA','KAYU') KONSTRUKSI,
DECODE(S.KD_DINDING, 1, 'KACA',2, 'BETON',3, 'BATU BATA',4,'KAYU',5,'SENG','TIDAK ADA') DINDING,
DECODE(S.JNS_ATAP_BNG, 1, 'Decrabon/Beton/Glazur',2, 'GENTENG BETON',3, 'GENTENG BIASA/SIRAP',4,'ASBES','SENG') ATAP,
DECODE(S.KD_LANTAI, 1, 'MARMER',2, 'KERAMIK',3, 'TERASO',4,'UBIN PC/PAPAN','SEMEN') LANTAI,
DECODE(S.KD_LANGIT_LANGIT, 1, 'AKUSTIK/JATI',2, 'TRIPLEK/ASBES/BAMBU','TIDAK ADA') LANGIT2,
(S.NILAI_SISTEM_BNG*1000) AS NILAI_SISTEM,(D.NILAI_INDIVIDU*1000) AS NILAI_INDIVIDU

from DAT_OP_BANGUNAN S
LEFT JOIN DAT_NILAI_INDIVIDU D ON ( 
S.KD_PROPINSI=D.KD_PROPINSI AND
S.KD_DATI2=D.KD_DATI2 AND
S.KD_KECAMATAN=D.KD_KECAMATAN AND
S.KD_KELURAHAN=D.KD_KELURAHAN AND
S.KD_BLOK=D.KD_BLOK AND
S.NO_URUT=D.NO_URUT AND
S.KD_JNS_OP=D.KD_JNS_OP AND 
S.NO_BNG=D.NO_BNG
)
LEFT JOIN REF_JPB J ON (
J.KD_JPB=S.KD_JPB
)
where S.KD_PROPINSI||S.KD_DATI2||S.KD_KECAMATAN||S.KD_KELURAHAN||S.KD_BLOK||S.NO_URUT||S.KD_JNS_OP in (
332008101000100090
)  ORDER BY D.NO_BNG ASC
]]>
         </code>
      </snippet>
      <snippet name="#ALTER-COLUM" description="">
         <code>
            <![CDATA[ALTER TABLE SPPT MODIFY (NM_WP_SPPT VARCHAR2(50));]]>
         </code>
      </snippet>
      <snippet name="#BILLER" description="">
         <code>
            <![CDATA[select THN_PAJAK_SPPT as TAHUN,SUM(LUAS_BUMI_SPPT) AS BUMI,SUM(LUAS_BNG_SPPT) AS BANGUNAN,
SUM(NJOP_BUMI_SPPT) AS NJOPBUMI,SUM(NJOP_BNG_SPPT) AS NJOPBANGUNAN from SPPT
WHERE THN_PAJAK_SPPT BETWEEN '2010' AND '2017' AND STATUS_PEMBAYARAN_SPPT IN (0,1) AND TGL_TERBIT_SPPT<TO_DATE('01012018','DDMMYYYY')

GROUP BY THN_PAJAK_SPPT 
ORDER BY THN_PAJAK_SPPT ASC]]>
         </code>
      </snippet>
      <snippet name="#BPS STATISTIK" description="">
         <code>
            <![CDATA[SELECT J.NM_JPB_JPT AS PERUNTUKAN_BANGUNAN,
(SELECT SUM(B.LUAS_BNG) FROM DAT_OP_BANGUNAN B WHERE J.KD_JPB_JPT=B.KD_JPB AND B.TGL_PEREKAMAN_BNG<TO_DATE('01012015','DDMMYYYY')) AS LUAS2014,
(SELECT SUM(B.LUAS_BNG) FROM DAT_OP_BANGUNAN B WHERE J.KD_JPB_JPT=B.KD_JPB AND B.TGL_PEREKAMAN_BNG<TO_DATE('01012016','DDMMYYYY')) AS LUAS2015,
(SELECT SUM(B.LUAS_BNG) FROM DAT_OP_BANGUNAN B WHERE J.KD_JPB_JPT=B.KD_JPB AND B.TGL_PEREKAMAN_BNG<TO_DATE('01012017','DDMMYYYY')) AS LUAS2016,
(SELECT SUM(B.LUAS_BNG) FROM DAT_OP_BANGUNAN B WHERE J.KD_JPB_JPT=B.KD_JPB AND B.TGL_PEREKAMAN_BNG<TO_DATE('01012018','DDMMYYYY')) AS LUAS2017,
(SELECT SUM(B.NILAI_SISTEM_BNG*1000) FROM DAT_OP_BANGUNAN B WHERE J.KD_JPB_JPT=B.KD_JPB AND B.TGL_PEREKAMAN_BNG<TO_DATE('01012015','DDMMYYYY')) AS NJOP2014,
(SELECT SUM(B.NILAI_SISTEM_BNG*1000) FROM DAT_OP_BANGUNAN B WHERE J.KD_JPB_JPT=B.KD_JPB AND B.TGL_PEREKAMAN_BNG<TO_DATE('01012016','DDMMYYYY')) AS NJOP2015,
(SELECT SUM(B.NILAI_SISTEM_BNG*1000) FROM DAT_OP_BANGUNAN B WHERE J.KD_JPB_JPT=B.KD_JPB AND B.TGL_PEREKAMAN_BNG<TO_DATE('01012017','DDMMYYYY')) AS NJOP2016,
(SELECT SUM(B.NILAI_SISTEM_BNG*1000) FROM DAT_OP_BANGUNAN B WHERE J.KD_JPB_JPT=B.KD_JPB AND B.TGL_PEREKAMAN_BNG<TO_DATE('01012018','DDMMYYYY')) AS NJOP2017

FROM 
JPB_JPT J]]>
         </code>
      </snippet>
      <snippet name="#PERBANDINGAN-NIR" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN,L.NM_KELURAHAN,N.KD_ZNT,
sum(decode(N.THN_NIR_ZNT,2016,N.NIR*1000,0)) AS NIR2016,
sum(decode(N.THN_NIR_ZNT,2019,N.NIR*1000,0)) AS NIR2019
FROM DAT_NIR N 
LEFT JOIN REF_KECAMATAN K ON (
N.KD_PROPINSI=K.KD_PROPINSI AND
N.KD_DATI2=K.KD_DATI2 AND
N.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
N.KD_PROPINSI=L.KD_PROPINSI AND
N.KD_DATI2=L.KD_DATI2 AND
N.KD_KECAMATAN=L.KD_KECAMATAN AND
N.KD_KELURAHAN=L.KD_KELURAHAN )
WHERE 
regexp_like(N.kd_znt, '[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]') 
group by K.NM_KECAMATAN,L.NM_KELURAHAN,N.KD_ZNT
ORDER BY K.NM_KECAMATAN,L.NM_KELURAHAN,N.KD_ZNT ASC;]]>
         </code>
      </snippet>
      <snippet name="#NJOP-TERTINGGI-TERENDAH" description="">
         <code>
            <![CDATA[SELECT * FROM DAT_NIR N WHERE N.THN_NIR_ZNT='2019' AND regexp_like(N.kd_znt, '[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ]') AND
EXISTS (SELECT * FROM DAT_OP_BUMI D WHERE
D.KD_PROPINSI=N.KD_PROPINSI AND 
D.KD_DATI2=N.KD_DATI2 AND 
D.KD_KECAMATAN=N.KD_KECAMATAN AND 
D.KD_KELURAHAN=N.KD_KELURAHAN AND 
D.KD_ZNT=N.KD_ZNT AND D.JNS_BUMI IN (1,2,3)
) ORDER BY N.NIR DESC
]]>
         </code>
      </snippet>
   </group>
   <group category="" language="PLSQL">
      <snippet name="#KODE" description="">
         <code>
            <![CDATA[SELECT K.NM_KECAMATAN as KECAMATAN,L.NM_KELURAHAN,LPAD('-'||K.KD_KECAMATAN||'-'||L.KD_KELURAHAN,'12','3320') AS KODE, 
SUM(S.PBB_YG_HARUS_DIBAYAR_SPPT) as POKOK, 
SUM(DECODE (STATUS_PEMBAYARAN_SPPT, 0,S.PBB_YG_HARUS_DIBAYAR_SPPT,0)) "PIUTANG", 
SUM(DECODE(STATUS_PEMBAYARAN_SPPT,1,S.PBB_YG_HARUS_DIBAYAR_SPPT,0))"REALISASI", 
count(*) as JMLSPPT, 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 0,1)) "BELUMLUNAS", 
COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) "LUNAS", 
TRUNC((COUNT(DECODE (S.STATUS_PEMBAYARAN_SPPT, 1,1)) / count(*))*100,2) AS PERSENTASE, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 5000 AND 100000 THEN 1 ELSE 0 END) AS R1, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 100001 AND 500000 THEN 1 ELSE 0 END) AS R2, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 500001 AND 1000000 THEN 1 ELSE 0 END) AS R3, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 1000001 AND 2000000 THEN 1 ELSE 0 END) AS R4, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 2000001 AND 5000000 THEN 1 ELSE 0 END) AS R5, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 5000001 AND 10000000 THEN 1 ELSE 0 END) AS R6, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 10000001 AND 25000000 THEN 1 ELSE 0 END) AS R7, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 25000001 AND 60000000 THEN 1 ELSE 0 END) AS R8, 
SUM(CASE WHEN S.PBB_YG_HARUS_DIBAYAR_SPPT BETWEEN 60000001  AND 300000000   THEN 1 ELSE 0 END) AS R9, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000  AND 100000 THEN 1500 ELSE 0 END) AS H1, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 100001  AND 500000 THEN 8000 ELSE 0 END) AS H2, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 500001  AND 1000000 THEN 25000 ELSE 0 END) AS H3, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 1000001  AND 2000000 THEN 50000 ELSE 0 END) AS H4, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 2000001  AND 5000000 THEN 350000 ELSE 0 END) AS H5, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 5000001  AND 10000000 THEN 550000 ELSE 0 END) AS H6, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 10000001  AND 25000000 THEN 800000 ELSE 0 END) AS H7, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT) BETWEEN 25000001  AND 60000000 THEN 2000000 ELSE 0 END) AS H8, 
SUM(CASE WHEN (S.PBB_YG_HARUS_DIBAYAR_SPPT)  BETWEEN 60000001  AND 300000000 THEN 3000000 ELSE 0 END) AS H9 
FROM SPPT S  
LEFT JOIN REF_KECAMATAN K ON ( 
S.KD_PROPINSI=K.KD_PROPINSI AND 
S.KD_DATI2=K.KD_DATI2 AND 
S.KD_KECAMATAN=K.KD_KECAMATAN ) 
LEFT JOIN pembayaran_sppt B ON ( 
S.KD_PROPINSI=B.KD_PROPINSI AND 
S.KD_DATI2=B.KD_DATI2 AND 
S.KD_KECAMATAN=B.KD_KECAMATAN AND 
S.KD_KELURAHAN=B.KD_KELURAHAN AND 
S.KD_BLOK=B.KD_BLOK AND 
S.NO_URUT=B.NO_URUT AND 
S.KD_JNS_OP=B.KD_JNS_OP AND 
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT 
) 
LEFT JOIN REF_KELURAHAN L ON ( 
S.KD_PROPINSI=L.KD_PROPINSI AND 
S.KD_DATI2=L.KD_DATI2 AND 
S.KD_KECAMATAN=L.KD_KECAMATAN AND 
S.KD_KELURAHAN=L.KD_KELURAHAN ) 
WHERE  S.THN_PAJAK_SPPT=2014
 
 
GROUP BY K.NM_KECAMATAN,K.KD_KECAMATAN,L.NM_KELURAHAN,L.KD_KELURAHAN ORDER BY KODE asc]]>
         </code>
      </snippet>
      <snippet name="#DAFNOM" description="">
         <code>
            <![CDATA[UPDATE DAFNOM_OP SET KATEGORI_OP=4 WHERE 
KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP='332006000301704520' OR
KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP='332006000301704530' OR
KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP='332006000301704540' OR
KD_PROPINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP='332006000301704550' ]]>
         </code>
      </snippet>
      <snippet name="#DAS" description="">
         <code>
            <![CDATA[
SELECT S.KD_PROPINSI||'.'||S.KD_DATI2||'.'||S.KD_KECAMATAN||'.'||S.KD_KELURAHAN||'.'||S.KD_BLOK||'.'||S.NO_URUT||'.'||S.KD_JNS_OP as NOP,
S.NM_WP_SPPT AS NAMA_WP,S.PBB_YG_HARUS_DIBAYAR_SPPT AS PBB_BAYAR,0 "DENDA",S.THN_PAJAK_SPPT "TAHUN", K.NM_KECAMATAN AS KECAMATAN,
L.NM_KELURAHAN "DESA", S.JLN_WP_SPPT||' - '||L.NM_KELURAHAN AS ALAMAT,S.LUAS_BUMI_SPPT "LUAS_BUMI",S.LUAS_BNG_SPPT "LUAS_BNG",
S.STATUS_PEMBAYARAN_SPPT "STATUSBAYAR",nvl(TO_CHAR(B.TGL_PEMBAYARAN_SPPT,'YYYY-MM-DD'),'2014-01-09') AS TANGGAL_TRANS
FROM SPPT S 
LEFT JOIN pembayaran_sppt B ON (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT
)
LEFT JOIN REF_KECAMATAN K ON (
S.KD_PROPINSI=K.KD_PROPINSI AND
S.KD_DATI2=K.KD_DATI2 AND
S.KD_KECAMATAN=K.KD_KECAMATAN )
LEFT JOIN REF_KELURAHAN L ON (
S.KD_PROPINSI=L.KD_PROPINSI AND
S.KD_DATI2=L.KD_DATI2 AND
S.KD_KECAMATAN=L.KD_KECAMATAN AND
S.KD_KELURAHAN=L.KD_KELURAHAN )
where s.THN_PAJAK_SPPT=2014 and S.STATUS_PEMBAYARAN_SPPT in (1) and
K.KD_KECAMATAN||L.KD_KELURAHAN=061004  AND 
B.TGL_PEMBAYARAN_SPPT < TO_DATE ('30-11-2014','DD-MM-YYYY') AND S.TGL_TERBIT_SPPT > TO_DATE('09-01-2014','DD-MM-YYYY')

 ORDER BY K.NM_KECAMATAN,S.KD_KELURAHAN ASC;

]]>
         </code>
      </snippet>
   </group>
   <group category="BILLER" language="PLSQL">
      <snippet name="#CEK FLAG" description="">
         <code>
            <![CDATA[select  BPDPRO||BPDDAT||BPDKEC||BPDKEL||BPDBLK||BPDNOR||BPDJNS||'#'||BPDTHN as cek,BPDNAM,BPDAMT,BPDFLG from BPDTRTX where BPDPRO||BPDDAT||BPDKEC||BPDKEL||BPDBLK||BPDNOR||BPDJNS='332002100401900170'

select BPDPRO||BPDDAT||BPDKEC||BPDKEL||BPDBLK||BPDNOR||BPDJNS||'#'||BPDTHN as cek from BPDTRTX where BPDCOD not in (00);

update BPDTRTX set BPDFLG=null where BPDCOD not in (00);


]]>
         </code>
      </snippet>
      <snippet name="#DUPLICAT ENTRI" description="">
         <code>
            <![CDATA[SELECT  * from BPDTRTX A1
where to_char(A1.BPDDTX,'yyyy')='2019' AND
 A1.rowid >
   ANY (
 SELECT
        A2.rowid
     FROM
        BPDTRTX A2
     WHERE
      A2.BPDPRO = A1.BPDPRO AND         
      A2.BPDDAT = A1.BPDDAT AND
      A2.BPDKEC = A1.BPDKEC AND     
      A2.BPDKEL = A1.BPDKEL AND     
      A2.BPDBLK = A1.BPDBLK AND     
      A2.BPDNOR = A1.BPDNOR AND   
      A2.BPDJNS = A1.BPDJNS   
 ); ]]>
         </code>
      </snippet>
      <snippet name="#CEK RECON" description="">
         <code>
            <![CDATA[SELECT SUM(BPDAMT) "POKOK",SUM(BPDPNT) "PINALTI",COUNT(*) AS SPPT,TRUNC(BPDRDT) FROM BPDTRTX 
WHERE TRUNC(BPDRDT)=TRUNC(SYSDATE)
GROUP BY TRUNC(BPDRDT) ORDER BY TRUNC(BPDRDT) DESC]]>
         </code>
      </snippet>
      <snippet name="#CEK PER TGL BAYAR" description="">
         <code>
            <![CDATA[SELECT SUM(BPDAMT) "POKOK",SUM(BPDPNT) "PINALTI",COUNT(*) AS SPPT,to_char(BPDDTX,'dd-mm-yyyy') FROM BPDTRTX
GROUP BY BPDDTX order by BPDDTX desc]]>
         </code>
      </snippet>
      <snippet name="#DEL DUPLIKAT " description="">
         <code>
            <![CDATA[DELETE  from BPDTRTX A1
where to_char(BPDDTX,'yyyy')='2019' AND
 A1.rowid >
   ANY (
 SELECT
        A2.rowid
     FROM
        BPDTRTX A2
     WHERE
      A2.BPDPRO = A1.BPDPRO AND         
      A2.BPDDAT = A1.BPDDAT AND
      A2.BPDKEC = A1.BPDKEC AND     
      A2.BPDKEL = A1.BPDKEL AND     
      A2.BPDBLK = A1.BPDBLK AND     
      A2.BPDNOR = A1.BPDNOR AND   
      A2.BPDJNS = A1.BPDJNS AND
      A2.BPDTHN = A1.BPDTHN

 ); ]]>
         </code>
      </snippet>
      <snippet name="#BILLER-H2H" description="">
         <code>
            <![CDATA[SELECT *
FROM BILLER_DETAIL S   WHERE 
EXISTS (SELECT * FROM pembayaran_sppt  B WHERE S.KD_PROVINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.TAHUN_SPPT=B.THN_PAJAK_SPPT 
)

AND S.KD_BILLER='332006001120190002']]>
         </code>
      </snippet>
      <snippet name="#BILLER-PEMBAYARANSPT" description="">
         <code>
            <![CDATA[SELECT *
FROM pembayaran_sppt  B WHERE 
EXISTS (SELECT * FROM BILLER_DETAIL S WHERE S.KD_PROVINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.TAHUN_SPPT=B.THN_PAJAK_SPPT AND S.KD_BILLER='332006001120190002'
)
]]>
         </code>
      </snippet>
      <snippet name="#DAFTAR KODEBAYAR" description="">
         <code>
            <![CDATA[SELECT rownum nomor,
A.TAHUNPAJAK,
A.KDBILLER,
A.JMLWP,
A.POKOK,
TO_CHAR(B.TGL_REKAM,'DD-MM-YYYY') AS TGLREKAM,
TO_CHAR(B.TGL_EXP-1,'DD-MM-YYYY') AS TGLEXP
FROM BILLER B,
(SELECT  KD_KECAMATAN, KD_KELURAHAN,SUBSTR(KD_BILLER,11,4) AS NOBILL, COUNT(*) JMLWP, SUM(POKOK) AS POKOK,KD_BILLER AS KDBILLER,TAHUN_SPPT AS TAHUNPAJAK FROM BILLER_DETAIL  GROUP BY  KD_KECAMATAN, KD_KELURAHAN,SUBSTR(KD_BILLER,11,4),KD_BILLER,TAHUN_SPPT) A
WHERE
B.KD_PROVINSI='33' AND B.KD_DATI2='20' AND
B.KD_KECAMATAN='060' AND B.KD_KELURAHAN='002' AND
B.KD_KECAMATAN=A.KD_KECAMATAN  AND
B.KD_KELURAHAN=A.KD_KELURAHAN  AND
B.TAHUN_BILLER=A.TAHUNPAJAK AND
LPAD(B.NO_BILLER,4,'0')=A.NOBILL ]]>
         </code>
      </snippet>
      <snippet name="#billerstatus" description="">
         <code>
            <![CDATA[SELECT rownum nomor,
A.TAHUNPAJAK,
A.KDBILLER,
A.JMLWP,
A.POKOK,
TO_CHAR(B.TGL_REKAM,'DD-MM-YYYY') AS TGLREKAM,
TO_CHAR(B.TGL_EXP-1,'DD-MM-YYYY') AS TGLEXP,
decode(B.FLAG_BILLER,0,'WAITING',1,'APPROVE') AS  FLAGBILL
FROM BILLER B,
(SELECT  KD_KECAMATAN, KD_KELURAHAN,SUBSTR(KD_BILLER,11,4) AS NOBILL, COUNT(*) JMLWP, SUM(POKOK) AS POKOK,KD_BILLER AS KDBILLER,TAHUN_SPPT AS TAHUNPAJAK FROM BILLER_DETAIL  GROUP BY  KD_KECAMATAN, KD_KELURAHAN,SUBSTR(KD_BILLER,11,4),KD_BILLER,TAHUN_SPPT) A
WHERE
B.KD_PROVINSI='33' AND B.KD_DATI2='20' AND
B.KD_KECAMATAN='060' AND B.KD_KELURAHAN='011' AND
B.KD_KECAMATAN=A.KD_KECAMATAN  AND
B.KD_KELURAHAN=A.KD_KELURAHAN  AND
B.TAHUN_BILLER=A.TAHUNPAJAK ]]>
         </code>
      </snippet>
      <snippet name="#TAHUN PEMBAYARAN" description="">
         <code>
            <![CDATA[SELECT * FROM PEMBAYARAN_SPPT WHERE  EXTRACT(YEAR FROM TO_DATE(TGL_PEMBAYARAN_SPPT , 'DD-MON-RR'))='2019' ]]>
         </code>
      </snippet>
      <snippet name="#TRIGERUPDATE" description="">
         <code>
            <![CDATA[create or replace TRIGGER BILLERUPD 
AFTER UPDATE ON BILLER 
FOR EACH ROW
BEGIN
UPDATE BILLER_DETAIL SET FLAG_DETAIL = '1'  WHERE SUBSTR(KD_BILLER,11,4)= LPAD(:OLD.NO_BILLER,4,'0');
--EXCEPTION WHEN OTHERS THEN NULL;
END BILLERUPD;]]>
         </code>
      </snippet>
      <snippet name="#UPDATE" description="">
         <code>
            <![CDATA[SELECT KD_PROVINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||LPAD(NO_BILLER,4,'0')||TAHUN_BILLER,FLAG_BILLER FROM BILLER;

UPDATE BILLER SET FLAG_BILLER='0'  WHERE KD_PROVINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||LPAD(NO_BILLER,4,'0')||TAHUN_BILLER='332002001100012019';
UPDATE BILLER_DETAIL SET FLAG_DETAIL ='0'  WHERE KD_BILLER='332002001100012019';]]>
         </code>
      </snippet>
      <snippet name="#CEK-PER-TGL" description="">
         <code>
            <![CDATA[SELECT to_char(TGL_PEMBAYARAN_SPPT,'dd-mm-yyyy') , SUM(JML_SPPT_YG_DIBAYAR)-SUM(DENDA_SPPT) "POKOK",COUNT(*) AS SPPT FROM PEMBAYARAN_SPPT 
GROUP BY TGL_PEMBAYARAN_SPPT ORDER BY TGL_PEMBAYARAN_SPPT DESC;]]>
         </code>
      </snippet>
      <snippet name="#realisasi_per_tgl" description="">
         <code>
            <![CDATA[SELECT to_char(TGL_PEMBAYARAN_SPPT,'dd-mm-yyyy') AS TGL,
sum(decode(KD_TP,008,(JML_SPPT_YG_DIBAYAR-DENDA_SPPT),0)) AS MANDIRI,
sum(decode(KD_TP,008,1,0)) AS WP,
SUM(CASE WHEN (KD_TP NOT IN (002,008)) THEN (JML_SPPT_YG_DIBAYAR-DENDA_SPPT) ELSE 0 END) AS JATENG, 
SUM(CASE WHEN (KD_TP NOT IN (002,008)) THEN 1 ELSE 0 END) AS WP2,
SUM(JML_SPPT_YG_DIBAYAR)-SUM(DENDA_SPPT) "POKOK",
COUNT(*) AS SPPT
--sum(decode(KD_TP,002,(JML_SPPT_YG_DIBAYAR-DENDA_SPPT),0)) AS BRI,
--sum(decode(KD_TP,002,1,0)) AS WP3,
FROM PEMBAYARAN_SPPT 
WHERE TGL_PEMBAYARAN_SPPT>TO_DATE('01-01-2019','DD-MM-YYYY')
GROUP BY TGL_PEMBAYARAN_SPPT 
ORDER BY TGL_PEMBAYARAN_SPPT DESC;]]>
         </code>
      </snippet>
      <snippet name="#CEK REKON SELISIH" description="">
         <code>
            <![CDATA[ select s.kd_propinsi, s.kd_dati2, s.kd_kecamatan, s.kd_kelurahan, s.kd_blok,
      s.no_urut, s.kd_jns_op, s.TAHUN_SPPT, kd_kanwil, kd_kantor,
      s.kd_tp,s.POKOK
    from BILLER_RECON s
left join sppt b on (
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.TAHUN_SPPT=B.THN_PAJAK_SPPT 
)
WHERE NOT
EXISTS (SELECT * FROM PEMBAYARAN_SPPT P WHERE
S.KD_PROPINSI=P.KD_PROPINSI AND
S.KD_DATI2=P.KD_DATI2 AND
S.KD_KECAMATAN=P.KD_KECAMATAN AND
S.KD_KELURAHAN=P.KD_KELURAHAN AND
S.KD_BLOK=P.KD_BLOK AND
S.NO_URUT=P.NO_URUT AND
S.KD_JNS_OP=P.KD_JNS_OP AND
S.TAHUN_SPPT=P.THN_PAJAK_SPPT 
)
    
    

    ]]>
         </code>
      </snippet>
      <snippet name="#SELISIH" description="">
         <code>
            <![CDATA[SELECT B.KD_PROPINSI ||''||B.KD_DATI2 ||''||
B.KD_KECAMATAN||''||B.KD_KELURAHAN||''||B.KD_BLOK||''||B.NO_URUT ||''||B.KD_JNS_OP AS NOP,
B.TAHUN_SPPT AS TAHUN , B.POKOK as SPPTBAYAR
, C.TGL_PEMBAYARAN_SPPT AS "TGL BAYAR", C.DENDA_SPPT AS DENDA, C.JML_SPPT_YG_DIBAYAR AS BANKBAYAR,
((C.JML_SPPT_YG_DIBAYAR-C.DENDA_SPPT)-B.POKOK) AS SELISIH
FROM BILLER_RECON B left join PEMBAYARAN_SPPT C on
B.KD_PROPINSI = C.KD_PROPINSI AND
B.KD_DATI2 = C.KD_DATI2 AND
B.KD_KECAMATAN =C.KD_KECAMATAN AND
B.KD_KELURAHAN = C.KD_KELURAHAN AND
B.KD_BLOK = C.KD_BLOK AND
B.NO_URUT = C.NO_URUT AND
B.KD_JNS_OP =C.KD_JNS_OP and
B.TAHUN_SPPT=C.THN_PAJAK_SPPT
where
C.TGL_PEMBAYARAN_SPPT=to_date('04-04-2019','DD-MM-YYYY')
order by selisih asc;]]>
         </code>
      </snippet>
      <snippet name="#CEK BILLER DETAIL VS BILLER" description="">
         <code>
            <![CDATA[SELECT B.*
FROM BILLER_DETAIL B   WHERE NOT 
EXISTS (SELECT * FROM BILLER A WHERE 
B.KD_PROVINSI=A.KD_PROVINSI AND
B.KD_DATI2=A.KD_DATI2 AND
B.KD_KECAMATAN=A.KD_KECAMATAN  AND
B.KD_KELURAHAN=A.KD_KELURAHAN  AND
B.TAHUN_SPPT=A.TAHUN_BILLER AND
SUBSTR(B.KD_BILLER,11,4)= LPAD(A.NO_BILLER,4,'0')
);
]]>
         </code>
      </snippet>
      <snippet name="#cek kode bayar" description="">
         <code>
            <![CDATA[SELECT rownum nomor,
A.TAHUNPAJAK,
A.KDBILLER,
A.JMLWP,
A.POKOK,
TO_CHAR(B.TGL_REKAM,'DD-MM-YYYY') AS TGLREKAM,
TO_CHAR(B.TGL_EXP-1,'DD-MM-YYYY') AS TGLEXP,
decode(B.FLAG_BILLER,0,'WAITING',1,'APPROVE') AS  FLAGBILL
FROM BILLER B,
(SELECT  KD_KECAMATAN, KD_KELURAHAN,SUBSTR(KD_BILLER,11,4) AS NOBILL, COUNT(*) JMLWP, SUM(POKOK) AS POKOK,KD_BILLER AS KDBILLER,TAHUN_SPPT AS TAHUNPAJAK FROM BILLER_DETAIL  GROUP BY  KD_KECAMATAN, KD_KELURAHAN,SUBSTR(KD_BILLER,11,4),KD_BILLER,TAHUN_SPPT) A
WHERE
B.KD_KECAMATAN=A.KD_KECAMATAN  AND
B.KD_KELURAHAN=A.KD_KELURAHAN  AND
B.TAHUN_BILLER=A.TAHUNPAJAK and
b.KD_PROVINSI||b.KD_DATI2||b.KD_KECAMATAN||b.KD_KELURAHAN||LPAD(b.NO_BILLER,4,'0')||b.TAHUN_BILLER='332006100900112019';]]>
         </code>
      </snippet>
      <snippet name="HAPUS NOP DETAIL" description="">
         <code>
            <![CDATA[SELECT * FROM BILLER_DETAIL WHERE FLAG_DETAIL='0' AND KD_PROVINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP IN (
332007000200200080,
332007000202400940
) AND TAHUN_SPPT='2019';


DELETE FROM BILLER_DETAIL WHERE FLAG_DETAIL='0' AND KD_PROVINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||KD_BLOK||NO_URUT||KD_JNS_OP IN (
332007000200200080,
332007000202400940
) AND TAHUN_SPPT='2019';]]>
         </code>
      </snippet>
      <snippet name="#HAPUSKODEBAYAR" description="">
         <code>
            <![CDATA[select KD_PROVINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||LPAD(NO_BILLER,4,'0') as bil from BILLER where FLAG_BILLER='0' and KD_PROVINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||LPAD(NO_BILLER,4,'0')='33200400040006' and TAHUN_BILLER='2019'

delete from biller where FLAG_BILLER='0' and KD_PROVINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||LPAD(NO_BILLER,4,'0')='33200400040006' and TAHUN_BILLER='2019';

select KD_PROVINSI||KD_DATI2||KD_KECAMATAN||KD_KELURAHAN||LPAD(NO_BILLER,4,'0') as bil,TAHUN_BILLER,TGL_EXP from BILLER where  FLAG_BILLER='0' and TGL_EXP<to_date('03-07-2019','DD-MM-YYYY')

delete from biller where FLAG_BILLER='0' and TGL_EXP<to_date('03-07-2019','DD-MM-YYYY') 
]]>
         </code>
      </snippet>
      <snippet name="#HAPUS BILLER TEMP" description="">
         <code>
            <![CDATA[SELECT * FROM BILLER_TEMP T WHERE  EXISTS (
SELECT * FROM BILLER_DETAIL D WHERE
D.KD_PROVINSI = T.KD_PROVINSI AND
D.KD_DATI2 = T.KD_DATI2 AND
D.KD_KECAMATAN =T.KD_KECAMATAN AND
D.KD_KELURAHAN = T.KD_KELURAHAN AND
D.KD_BLOK = T.KD_BLOK AND
D.NO_URUT = T.NO_URUT AND
D.KD_JNS_OP =T.KD_JNS_OP and
D.TAHUN_SPPT=T.TAHUN_SPPT
);

DELETE FROM BILLER_TEMP T WHERE  EXISTS (
SELECT * FROM BILLER_DETAIL D WHERE
D.KD_PROVINSI = T.KD_PROVINSI AND
D.KD_DATI2 = T.KD_DATI2 AND
D.KD_KECAMATAN =T.KD_KECAMATAN AND
D.KD_KELURAHAN = T.KD_KELURAHAN AND
D.KD_BLOK = T.KD_BLOK AND
D.NO_URUT = T.NO_URUT AND
D.KD_JNS_OP =T.KD_JNS_OP and
D.TAHUN_SPPT=T.TAHUN_SPPT
);]]>
         </code>
      </snippet>
      <snippet name="#HAPUS-DETAIL-BILLER" description="">
         <code>
            <![CDATA[select * from BILLER_DETAIL b where b.KD_BILLER='332002000400022019' and EXISTS (
select * from pembayaran_sppt S where 
S.KD_DATI2=B.KD_DATI2 AND
S.KD_PROPINSI=b.KD_PROVINSI AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=b.TAHUN_SPPT
); 

delete from BILLER_DETAIL b where b.KD_BILLER='332002000400022019' and EXISTS (
select * from pembayaran_sppt S where 
S.KD_DATI2=B.KD_DATI2 AND
S.KD_PROPINSI=b.KD_PROVINSI AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=b.TAHUN_SPPT
and b.FLAG_DETAIL='0'
); ]]>
         </code>
      </snippet>
      <snippet name="#BILLERDENDA" description="">
         <code>
            <![CDATA[SELECT rownum nomor,
A.TAHUNPAJAK,
A.KDBILLER,
A.JMLWP,
A.POKOK,
A.DENDA,
TO_CHAR(B.TGL_REKAM,'DD-MM-YYYY') AS TGLREKAM,
TO_CHAR(B.TGL_EXP-1,'DD-MM-YYYY') AS TGLEXP,
TO_CHAR(B.TGL_APPROVE,'DD-MM-YYYY') AS TGLBAYAR,
decode(B.FLAG_BILLER,0,'WAITING',1,'APPROVE') AS  FLAGBILL
FROM BILLER B,
(SELECT  D.KD_KECAMATAN, D.KD_KELURAHAN,SUBSTR(D.KD_BILLER,11,4) AS NOBILL, COUNT(*) JMLWP, SUM(POKOK) AS POKOK,
CASE D.FLAG_DETAIL WHEN '0' THEN 
sum(HITUNG_DENDA_BILL(S.TGL_JATUH_TEMPO_SPPT,sysdate,S.PBB_YG_HARUS_DIBAYAR_SPPT)) 
ELSE 
sum(HITUNG_DENDA_BILL(S.TGL_JATUH_TEMPO_SPPT,p.TGL_PEMBAYARAN_SPPT,S.PBB_YG_HARUS_DIBAYAR_SPPT)) END AS DENDA,
 KD_BILLER AS KDBILLER,TAHUN_SPPT AS TAHUNPAJAK 
FROM BILLER_DETAIL D
left join  SPPT S on  ( 
D.KD_PROVINSI=S.KD_PROPINSI  AND
D.KD_DATI2=S.KD_DATI2  AND
D.KD_KECAMATAN=S.KD_KECAMATAN  AND
D.KD_KELURAHAN=S.KD_KELURAHAN  AND
D.KD_BLOK=S.KD_BLOK  AND
D.NO_URUT=S.NO_URUT  AND
D.KD_JNS_OP=S.KD_JNS_OP  AND
D.TAHUN_SPPT=S.THN_PAJAK_SPPT) 
left join  pembayaran_sppt p on  ( 
D.KD_PROVINSI=p.KD_PROPINSI  AND
D.KD_DATI2=p.KD_DATI2  AND
D.KD_KECAMATAN=p.KD_KECAMATAN  AND
D.KD_KELURAHAN=p.KD_KELURAHAN  AND
D.KD_BLOK=p.KD_BLOK  AND
D.NO_URUT=p.NO_URUT  AND
D.KD_JNS_OP=p.KD_JNS_OP  AND
D.TAHUN_SPPT=p.THN_PAJAK_SPPT) 
where
 S.STATUS_PEMBAYARAN_SPPT IN (0,1)
GROUP BY  D.KD_KECAMATAN, D.KD_KELURAHAN,SUBSTR(D.KD_BILLER,11,4),D.KD_BILLER,D.TAHUN_SPPT,D.FLAG_DETAIL) A
WHERE
B.KD_PROVINSI='33' AND B.KD_DATI2='20' AND
B.KD_KECAMATAN='010' AND B.KD_KELURAHAN='001' AND
B.KD_KECAMATAN=A.KD_KECAMATAN  AND
B.KD_KELURAHAN=A.KD_KELURAHAN  AND
B.TAHUN_BILLER=A.TAHUNPAJAK AND
LPAD(B.NO_BILLER,4,'0')=A.NOBILL
AND B.TAHUN_BILLER='2019'
]]>
         </code>
      </snippet>
   </group>
   <group category="#OLAHPIUTANG" language="PLSQL">
      <snippet name="#FLAG BAYAR" description="">
         <code>
            <![CDATA[UPDATE SPPT_2009_2013 S SET S.STATTUS_B='1',S.STATUS_V='1',S.STATUS_LUNAS='1' WHERE EXISTS (SELECT * FROM PEMBAYARAN_SPPT B WHERE
S.KD_PROPINSI=B.KD_PROPINSI AND
S.KD_DATI2=B.KD_DATI2 AND
S.KD_KECAMATAN=B.KD_KECAMATAN AND
S.KD_KELURAHAN=B.KD_KELURAHAN AND
S.KD_BLOK=B.KD_BLOK AND
S.NO_URUT=B.NO_URUT AND
S.KD_JNS_OP=B.KD_JNS_OP AND
S.THN_PAJAK_SPPT=B.THN_PAJAK_SPPT AND
B.TGL_PEMBAYARAN_SPPT > TO_DATE('01-01-2014','DD-MM-YYYY')
);
]]>
         </code>
      </snippet>
      <snippet name="#REKAP PER TAHUN" description="">
         <code>
            <![CDATA[SELECT S.THN_PAJAK_SPPT "TAHUN",SUM(S.PBB_POKOK) "TUNGGAKAN PBB",COUNT(*) AS SPPT
FROM SPPT_2009_2013 S where S.THN_PAJAK_SPPT BETWEEN '2009' AND '2013' 


GROUP BY S.THN_PAJAK_SPPT
ORDER BY S.THN_PAJAK_SPPT ASC]]>
         </code>
      </snippet>
      <snippet name="#UPDATE_NIR_ANOTHER_TABLE" description="">
         <code>
            <![CDATA[UPDATE DAT_NIR D SET (D.NIR)=(SELECT T.NIR_BARU FROM TEMP_UPDATE_NIR_2019 T WHERE 
T.KD_PROPINSI=D.KD_PROPINSI AND   
T.KD_DATI2=D.KD_DATI2 AND   
T.KD_KECAMATAN=D.KD_KECAMATAN AND   
T.KD_KELURAHAN=D.KD_KELURAHAN AND   
T.KD_ZNT=D.KD_ZNT
) WHERE  D.THN_NIR_ZNT='2019' AND EXISTS (
    SELECT *
      FROM  TEMP_UPDATE_NIR_2019 T
     WHERE T.KD_PROPINSI=D.KD_PROPINSI AND   
T.KD_DATI2=D.KD_DATI2 AND   
T.KD_KECAMATAN=D.KD_KECAMATAN AND   
T.KD_KELURAHAN=D.KD_KELURAHAN AND   
T.KD_ZNT=D.KD_ZNT   );
]]>
         </code>
      </snippet>
      <snippet name="#NIR_RATA2_BPHTB_BARU" description="">
         <code>
            <![CDATA[SELECT  T.KD_PROPINSI,T.KD_DATI2,T.KD_KECAMATAN,T.KD_KELURAHAN,D.KD_ZNT,(SUM(T.NIRBARU)/COUNT(*))/1000 AS NIR  FROM TEMP_NIR_2019 T
LEFT JOIN DAT_OP_BUMI D ON
T.KD_PROPINSI=D.KD_PROPINSI AND   
T.KD_DATI2=D.KD_DATI2 AND   
T.KD_KECAMATAN=D.KD_KECAMATAN AND   
T.KD_KELURAHAN=D.KD_KELURAHAN AND
T.KD_BLOK=D.KD_BLOK AND 
T.NO_URUT=D.NO_URUT AND 
T.KD_JENIS=D.KD_JNS_OP 
LEFT JOIN DAT_NIR N ON
N.KD_PROPINSI=D.KD_PROPINSI AND   
N.KD_DATI2=D.KD_DATI2 AND   
N.KD_KECAMATAN=D.KD_KECAMATAN AND   
N.KD_KELURAHAN=D.KD_KELURAHAN AND
N.KD_ZNT=D.KD_ZNT AND
N.THN_NIR_ZNT='2019']]>
         </code>
      </snippet>
      <snippet name="#UPDATE_DAT_nir_BPHTB BARU" description="">
         <code>
            <![CDATA[UPDATE DAT_NIR D SET (D.NIR)=(SELECT T.NIR_BARU FROM TEMP_INSERT_NIR_BARU T WHERE 
T.KD_PROPINSI=D.KD_PROPINSI AND   
T.KD_DATI2=D.KD_DATI2 AND   
T.KD_KECAMATAN=D.KD_KECAMATAN AND   
T.KD_KELURAHAN=D.KD_KELURAHAN AND   
T.KD_ZNT=D.KD_ZNT AND
T.TAHUN_PENDATAAN='2018'
) WHERE  D.THN_NIR_ZNT='2019' AND EXISTS (
    SELECT *
      FROM  TEMP_INSERT_NIR_BARU T
     WHERE T.KD_PROPINSI=D.KD_PROPINSI AND   
T.KD_DATI2=D.KD_DATI2 AND   
T.KD_KECAMATAN=D.KD_KECAMATAN AND   
T.KD_KELURAHAN=D.KD_KELURAHAN AND   
T.KD_ZNT=D.KD_ZNT AND T.TAHUN_PENDATAAN='2018');
]]>
         </code>
      </snippet>
   </group>
   <group category="#NILAI_RATA2_NIR_BPHTB" language="PLSQL">
      <snippet name="" description="">
         <code>
            <![CDATA[SELECT  T.KD_PROPINSI,T.KD_DATI2,T.KD_KECAMATAN,T.KD_KELURAHAN,D.KD_ZNT,SUM(T.NIRBARU)/COUNT(*) AS NIR  FROM TEMP_NIR_2019 T
LEFT JOIN DAT_OP_BUMI D ON
T.KD_PROPINSI=D.KD_PROPINSI AND   
T.KD_DATI2=D.KD_DATI2 AND   
T.KD_KECAMATAN=D.KD_KECAMATAN AND   
T.KD_KELURAHAN=D.KD_KELURAHAN AND
T.KD_BLOK=D.KD_BLOK AND 
T.NO_URUT=D.NO_URUT AND 
T.KD_JENIS=D.KD_JNS_OP 
LEFT JOIN DAT_NIR N ON
N.KD_PROPINSI=D.KD_PROPINSI AND   
N.KD_DATI2=D.KD_DATI2 AND   
N.KD_KECAMATAN=D.KD_KECAMATAN AND   
N.KD_KELURAHAN=D.KD_KELURAHAN AND
N.KD_ZNT=D.KD_ZNT AND
N.THN_NIR_ZNT='2019'

GROUP BY T.KD_PROPINSI,T.KD_DATI2,T.KD_KECAMATAN,T.KD_KELURAHAN,D.KD_ZNT]]>
         </code>
      </snippet>
   </group>
</snippets>
